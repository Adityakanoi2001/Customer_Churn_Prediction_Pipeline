[2025-08-18T20:40:11.556+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: customer_churn_pipeline.model_training manual__2025-08-18T20:39:24.887519+00:00 [queued]>
[2025-08-18T20:40:11.571+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: customer_churn_pipeline.model_training manual__2025-08-18T20:39:24.887519+00:00 [queued]>
[2025-08-18T20:40:11.573+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2025-08-18T20:40:11.597+0000] {taskinstance.py:2217} INFO - Executing <Task(BashOperator): model_training> on 2025-08-18 20:39:24.887519+00:00
[2025-08-18T20:40:11.604+0000] {standard_task_runner.py:60} INFO - Started process 903 to run task
[2025-08-18T20:40:11.610+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'customer_churn_pipeline', 'model_training', 'manual__2025-08-18T20:39:24.887519+00:00', '--job-id', '20', '--raw', '--subdir', 'DAGS_FOLDER/customer_churn_pipeline_dag.py', '--cfg-path', '/tmp/tmpoxk570m0']
[2025-08-18T20:40:11.614+0000] {standard_task_runner.py:88} INFO - Job 20: Subtask model_training
[2025-08-18T20:40:11.717+0000] {task_command.py:423} INFO - Running <TaskInstance: customer_churn_pipeline.model_training manual__2025-08-18T20:39:24.887519+00:00 [running]> on host 2e4674d7276b
[2025-08-18T20:40:11.823+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='customer_churn_pipeline' AIRFLOW_CTX_TASK_ID='model_training' AIRFLOW_CTX_EXECUTION_DATE='2025-08-18T20:39:24.887519+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-08-18T20:39:24.887519+00:00'
[2025-08-18T20:40:11.825+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-08-18T20:40:11.827+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /opt/***/Customer_Churn_Prediction_Pipeline && python src/train_model.py']
[2025-08-18T20:40:11.841+0000] {subprocess.py:86} INFO - Output:
[2025-08-18T20:40:14.562+0000] {subprocess.py:93} INFO - 2025-08-18 20:40:14,562 INFO Loading features and target from feature store...
[2025-08-18T20:40:14.564+0000] {subprocess.py:93} INFO - 2025-08-18 20:40:14,562 INFO Connecting to SQLite DB at data/features/churn_features.db
[2025-08-18T20:40:14.582+0000] {subprocess.py:93} INFO - 2025-08-18 20:40:14,582 INFO Available tables: ['churn_features']
[2025-08-18T20:40:15.006+0000] {subprocess.py:93} INFO - 2025-08-18 20:40:15,006 INFO Retrieved 7032 rows and 36 columns from table churn_features
[2025-08-18T20:40:15.011+0000] {subprocess.py:93} INFO - 2025-08-18 20:40:15,010 INFO Features shape: (7032, 35), Target shape: (7032,)
[2025-08-18T20:40:15.012+0000] {subprocess.py:93} INFO - 2025-08-18 20:40:15,011 INFO Loaded features shape: (7032, 35), target shape: (7032,)
[2025-08-18T20:40:15.013+0000] {subprocess.py:93} INFO - 2025-08-18 20:40:15,011 INFO Splitting data into train and test sets (80/20, stratified)...
[2025-08-18T20:40:16.265+0000] {subprocess.py:93} INFO - 2025-08-18 20:40:16,264 INFO Training Logistic Regression...
[2025-08-18T20:40:18.655+0000] {subprocess.py:93} INFO - 2025-08-18 20:40:18,654 INFO Logistic Regression recall: 0.5187, accuracy: 0.7946, precision: 0.6403, f1: 0.5731
[2025-08-18T20:40:18.665+0000] {subprocess.py:93} INFO - 2025-08-18 20:40:18,664 INFO Classification report:
[2025-08-18T20:40:18.666+0000] {subprocess.py:93} INFO -               precision    recall  f1-score   support
[2025-08-18T20:40:18.667+0000] {subprocess.py:93} INFO - 
[2025-08-18T20:40:18.668+0000] {subprocess.py:93} INFO -            0       0.84      0.89      0.86      1033
[2025-08-18T20:40:18.669+0000] {subprocess.py:93} INFO -            1       0.64      0.52      0.57       374
[2025-08-18T20:40:18.670+0000] {subprocess.py:93} INFO - 
[2025-08-18T20:40:18.671+0000] {subprocess.py:93} INFO -     accuracy                           0.79      1407
[2025-08-18T20:40:18.671+0000] {subprocess.py:93} INFO -    macro avg       0.74      0.71      0.72      1407
[2025-08-18T20:40:18.672+0000] {subprocess.py:93} INFO - weighted avg       0.78      0.79      0.79      1407
[2025-08-18T20:40:18.673+0000] {subprocess.py:93} INFO - 
[2025-08-18T20:40:19.428+0000] {subprocess.py:93} INFO - 2025-08-18 20:40:19,428 INFO Training Random Forest Classifier...
[2025-08-18T20:40:21.015+0000] {subprocess.py:93} INFO - 2025-08-18 20:40:21,015 INFO Random Forest recall: 0.4706, accuracy: 0.7910, precision: 0.6471, f1: 0.5449
[2025-08-18T20:40:21.033+0000] {subprocess.py:93} INFO - 2025-08-18 20:40:21,033 INFO Classification report:
[2025-08-18T20:40:21.035+0000] {subprocess.py:93} INFO -               precision    recall  f1-score   support
[2025-08-18T20:40:21.036+0000] {subprocess.py:93} INFO - 
[2025-08-18T20:40:21.037+0000] {subprocess.py:93} INFO -            0       0.83      0.91      0.86      1033
[2025-08-18T20:40:21.038+0000] {subprocess.py:93} INFO -            1       0.65      0.47      0.54       374
[2025-08-18T20:40:21.040+0000] {subprocess.py:93} INFO - 
[2025-08-18T20:40:21.042+0000] {subprocess.py:93} INFO -     accuracy                           0.79      1407
[2025-08-18T20:40:21.044+0000] {subprocess.py:93} INFO -    macro avg       0.74      0.69      0.70      1407
[2025-08-18T20:40:21.045+0000] {subprocess.py:93} INFO - weighted avg       0.78      0.79      0.78      1407
[2025-08-18T20:40:21.047+0000] {subprocess.py:93} INFO - 
[2025-08-18T20:40:21.246+0000] {subprocess.py:93} INFO - 2025-08-18 20:40:21,246 INFO Best model (LogisticRegression) saved to models/churn_model.pkl with recall 0.5187
[2025-08-18T20:40:27.182+0000] {subprocess.py:93} INFO - /home/***/.local/lib/python3.8/site-packages/mlflow/types/utils.py:407: UserWarning: Hint: Inferred schema contains integer column(s). Integer columns in Python cannot represent missing values. If your input data contains missing values at inference time, it will be encoded as floats and will cause a schema enforcement error. The best way to avoid this problem is to infer the model schema based on a realistic data sample (training dataset) that includes missing values. Alternatively, you can declare integer columns as doubles (float64) whenever these columns may have missing values. See `Handling Integers With Missing Values <https://www.mlflow.org/docs/latest/models.html#handling-integers-with-missing-values>`_ for more details.
[2025-08-18T20:40:27.185+0000] {subprocess.py:93} INFO -   warnings.warn(
[2025-08-18T20:40:27.207+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2025-08-18T20:40:27.209+0000] {subprocess.py:93} INFO -   File "src/train_model.py", line 132, in <module>
[2025-08-18T20:40:27.211+0000] {subprocess.py:93} INFO -     mlflow.sklearn.log_model(
[2025-08-18T20:40:27.213+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/mlflow/sklearn/__init__.py", line 413, in log_model
[2025-08-18T20:40:27.215+0000] {subprocess.py:93} INFO -     return Model.log(
[2025-08-18T20:40:27.216+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/mlflow/models/model.py", line 744, in log
[2025-08-18T20:40:27.218+0000] {subprocess.py:93} INFO -     mlflow.tracking.fluent.log_artifacts(local_path, mlflow_model.artifact_path, run_id)
[2025-08-18T20:40:27.220+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 1170, in log_artifacts
[2025-08-18T20:40:27.221+0000] {subprocess.py:93} INFO -     MlflowClient().log_artifacts(run_id, local_dir, artifact_path)
[2025-08-18T20:40:27.223+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 1977, in log_artifacts
[2025-08-18T20:40:27.225+0000] {subprocess.py:93} INFO -     self._tracking_client.log_artifacts(run_id, local_dir, artifact_path)
[2025-08-18T20:40:27.227+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 874, in log_artifacts
[2025-08-18T20:40:27.229+0000] {subprocess.py:93} INFO -     self._get_artifact_repo(run_id).log_artifacts(local_dir, artifact_path)
[2025-08-18T20:40:27.231+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/mlflow/store/artifact/local_artifact_repo.py", line 66, in log_artifacts
[2025-08-18T20:40:27.233+0000] {subprocess.py:93} INFO -     mkdir(artifact_dir)
[2025-08-18T20:40:27.235+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/mlflow/utils/file_utils.py", line 211, in mkdir
[2025-08-18T20:40:27.238+0000] {subprocess.py:93} INFO -     raise e
[2025-08-18T20:40:27.240+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/mlflow/utils/file_utils.py", line 208, in mkdir
[2025-08-18T20:40:27.242+0000] {subprocess.py:93} INFO -     os.makedirs(target, exist_ok=True)
[2025-08-18T20:40:27.244+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.8/os.py", line 213, in makedirs
[2025-08-18T20:40:27.246+0000] {subprocess.py:93} INFO -     makedirs(head, exist_ok=exist_ok)
[2025-08-18T20:40:27.249+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.8/os.py", line 213, in makedirs
[2025-08-18T20:40:27.251+0000] {subprocess.py:93} INFO -     makedirs(head, exist_ok=exist_ok)
[2025-08-18T20:40:27.252+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.8/os.py", line 213, in makedirs
[2025-08-18T20:40:27.254+0000] {subprocess.py:93} INFO -     makedirs(head, exist_ok=exist_ok)
[2025-08-18T20:40:27.255+0000] {subprocess.py:93} INFO -   [Previous line repeated 7 more times]
[2025-08-18T20:40:27.257+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.8/os.py", line 223, in makedirs
[2025-08-18T20:40:27.258+0000] {subprocess.py:93} INFO -     mkdir(name, mode)
[2025-08-18T20:40:27.259+0000] {subprocess.py:93} INFO - PermissionError: [Errno 13] Permission denied: '/C:'
[2025-08-18T20:40:27.836+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2025-08-18T20:40:27.858+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 212, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2025-08-18T20:40:27.865+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=customer_churn_pipeline, task_id=model_training, execution_date=20250818T203924, start_date=20250818T204011, end_date=20250818T204027
[2025-08-18T20:40:27.895+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 20 for task model_training (Bash command failed. The command returned a non-zero exit code 1.; 903)
[2025-08-18T20:40:27.929+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2025-08-18T20:40:27.969+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
