[2025-08-18T20:21:15.023+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: customer_churn_pipeline.model_training manual__2025-08-18T20:20:37.622330+00:00 [queued]>
[2025-08-18T20:21:15.039+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: customer_churn_pipeline.model_training manual__2025-08-18T20:20:37.622330+00:00 [queued]>
[2025-08-18T20:21:15.040+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2025-08-18T20:21:15.060+0000] {taskinstance.py:2217} INFO - Executing <Task(BashOperator): model_training> on 2025-08-18 20:20:37.622330+00:00
[2025-08-18T20:21:15.067+0000] {standard_task_runner.py:60} INFO - Started process 854 to run task
[2025-08-18T20:21:15.072+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'customer_churn_pipeline', 'model_training', 'manual__2025-08-18T20:20:37.622330+00:00', '--job-id', '43', '--raw', '--subdir', 'DAGS_FOLDER/customer_churn_pipeline_dag.py', '--cfg-path', '/tmp/tmpe3qsj7pp']
[2025-08-18T20:21:15.075+0000] {standard_task_runner.py:88} INFO - Job 43: Subtask model_training
[2025-08-18T20:21:15.146+0000] {task_command.py:423} INFO - Running <TaskInstance: customer_churn_pipeline.model_training manual__2025-08-18T20:20:37.622330+00:00 [running]> on host 6cfe0da8a177
[2025-08-18T20:21:15.247+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='customer_churn_pipeline' AIRFLOW_CTX_TASK_ID='model_training' AIRFLOW_CTX_EXECUTION_DATE='2025-08-18T20:20:37.622330+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-08-18T20:20:37.622330+00:00'
[2025-08-18T20:21:15.249+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-08-18T20:21:15.251+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /opt/***/Customer_Churn_Prediction_Pipeline && python src/train_model.py']
[2025-08-18T20:21:15.265+0000] {subprocess.py:86} INFO - Output:
[2025-08-18T20:21:17.873+0000] {subprocess.py:93} INFO - 2025-08-18 20:21:17,872 INFO Loading features and target from feature store...
[2025-08-18T20:21:17.874+0000] {subprocess.py:93} INFO - 2025-08-18 20:21:17,873 INFO Connecting to SQLite DB at data/features/churn_features.db
[2025-08-18T20:21:17.897+0000] {subprocess.py:93} INFO - 2025-08-18 20:21:17,897 INFO Available tables: ['churn_features']
[2025-08-18T20:21:18.309+0000] {subprocess.py:93} INFO - 2025-08-18 20:21:18,309 INFO Retrieved 7032 rows and 36 columns from table churn_features
[2025-08-18T20:21:18.326+0000] {subprocess.py:93} INFO - 2025-08-18 20:21:18,326 INFO Features shape: (7032, 35), Target shape: (7032,)
[2025-08-18T20:21:18.351+0000] {subprocess.py:93} INFO - 2025-08-18 20:21:18,327 INFO Loaded features shape: (7032, 35), target shape: (7032,)
[2025-08-18T20:21:18.354+0000] {subprocess.py:93} INFO - 2025-08-18 20:21:18,327 INFO Splitting data into train and test sets (80/20, stratified)...
[2025-08-18T20:21:20.721+0000] {subprocess.py:93} INFO - 2025-08-18 20:21:20,720 INFO Training Logistic Regression...
[2025-08-18T20:21:24.519+0000] {subprocess.py:93} INFO - 2025-08-18 20:21:24,518 INFO Logistic Regression recall: 0.5187, accuracy: 0.7946, precision: 0.6403, f1: 0.5731
[2025-08-18T20:21:24.545+0000] {subprocess.py:93} INFO - 2025-08-18 20:21:24,545 INFO Classification report:
[2025-08-18T20:21:24.547+0000] {subprocess.py:93} INFO -               precision    recall  f1-score   support
[2025-08-18T20:21:24.548+0000] {subprocess.py:93} INFO - 
[2025-08-18T20:21:24.550+0000] {subprocess.py:93} INFO -            0       0.84      0.89      0.86      1033
[2025-08-18T20:21:24.552+0000] {subprocess.py:93} INFO -            1       0.64      0.52      0.57       374
[2025-08-18T20:21:24.554+0000] {subprocess.py:93} INFO - 
[2025-08-18T20:21:24.555+0000] {subprocess.py:93} INFO -     accuracy                           0.79      1407
[2025-08-18T20:21:24.557+0000] {subprocess.py:93} INFO -    macro avg       0.74      0.71      0.72      1407
[2025-08-18T20:21:24.558+0000] {subprocess.py:93} INFO - weighted avg       0.78      0.79      0.79      1407
[2025-08-18T20:21:24.560+0000] {subprocess.py:93} INFO - 
[2025-08-18T20:21:26.111+0000] {subprocess.py:93} INFO - 2025-08-18 20:21:26,111 INFO Training Random Forest Classifier...
[2025-08-18T20:21:27.896+0000] {subprocess.py:93} INFO - 2025-08-18 20:21:27,895 INFO Random Forest recall: 0.4706, accuracy: 0.7910, precision: 0.6471, f1: 0.5449
[2025-08-18T20:21:27.910+0000] {subprocess.py:93} INFO - 2025-08-18 20:21:27,910 INFO Classification report:
[2025-08-18T20:21:27.911+0000] {subprocess.py:93} INFO -               precision    recall  f1-score   support
[2025-08-18T20:21:27.912+0000] {subprocess.py:93} INFO - 
[2025-08-18T20:21:27.913+0000] {subprocess.py:93} INFO -            0       0.83      0.91      0.86      1033
[2025-08-18T20:21:27.914+0000] {subprocess.py:93} INFO -            1       0.65      0.47      0.54       374
[2025-08-18T20:21:27.915+0000] {subprocess.py:93} INFO - 
[2025-08-18T20:21:27.915+0000] {subprocess.py:93} INFO -     accuracy                           0.79      1407
[2025-08-18T20:21:27.916+0000] {subprocess.py:93} INFO -    macro avg       0.74      0.69      0.70      1407
[2025-08-18T20:21:27.917+0000] {subprocess.py:93} INFO - weighted avg       0.78      0.79      0.78      1407
[2025-08-18T20:21:27.918+0000] {subprocess.py:93} INFO - 
[2025-08-18T20:21:28.051+0000] {subprocess.py:93} INFO - 2025-08-18 20:21:28,051 INFO Best model (LogisticRegression) saved to models/churn_model.pkl with recall 0.5187
[2025-08-18T20:21:37.059+0000] {subprocess.py:93} INFO - /home/***/.local/lib/python3.8/site-packages/mlflow/types/utils.py:407: UserWarning: Hint: Inferred schema contains integer column(s). Integer columns in Python cannot represent missing values. If your input data contains missing values at inference time, it will be encoded as floats and will cause a schema enforcement error. The best way to avoid this problem is to infer the model schema based on a realistic data sample (training dataset) that includes missing values. Alternatively, you can declare integer columns as doubles (float64) whenever these columns may have missing values. See `Handling Integers With Missing Values <https://www.mlflow.org/docs/latest/models.html#handling-integers-with-missing-values>`_ for more details.
[2025-08-18T20:21:37.062+0000] {subprocess.py:93} INFO -   warnings.warn(
[2025-08-18T20:21:37.255+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2025-08-18T20:21:37.257+0000] {subprocess.py:93} INFO -   File "src/train_model.py", line 92, in <module>
[2025-08-18T20:21:37.258+0000] {subprocess.py:93} INFO -     mlflow.sklearn.log_model(best_model, artifact_path='model', input_example=input_example)
[2025-08-18T20:21:37.260+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/mlflow/sklearn/__init__.py", line 413, in log_model
[2025-08-18T20:21:37.263+0000] {subprocess.py:93} INFO -     return Model.log(
[2025-08-18T20:21:37.264+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/mlflow/models/model.py", line 744, in log
[2025-08-18T20:21:37.267+0000] {subprocess.py:93} INFO -     mlflow.tracking.fluent.log_artifacts(local_path, mlflow_model.artifact_path, run_id)
[2025-08-18T20:21:37.269+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/mlflow/tracking/fluent.py", line 1170, in log_artifacts
[2025-08-18T20:21:37.277+0000] {subprocess.py:93} INFO -     MlflowClient().log_artifacts(run_id, local_dir, artifact_path)
[2025-08-18T20:21:37.280+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/mlflow/tracking/client.py", line 1977, in log_artifacts
[2025-08-18T20:21:37.283+0000] {subprocess.py:93} INFO -     self._tracking_client.log_artifacts(run_id, local_dir, artifact_path)
[2025-08-18T20:21:37.285+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/mlflow/tracking/_tracking_service/client.py", line 874, in log_artifacts
[2025-08-18T20:21:37.286+0000] {subprocess.py:93} INFO -     self._get_artifact_repo(run_id).log_artifacts(local_dir, artifact_path)
[2025-08-18T20:21:37.291+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/mlflow/store/artifact/local_artifact_repo.py", line 66, in log_artifacts
[2025-08-18T20:21:37.293+0000] {subprocess.py:93} INFO -     mkdir(artifact_dir)
[2025-08-18T20:21:37.298+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/mlflow/utils/file_utils.py", line 211, in mkdir
[2025-08-18T20:21:37.300+0000] {subprocess.py:93} INFO -     raise e
[2025-08-18T20:21:37.301+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/mlflow/utils/file_utils.py", line 208, in mkdir
[2025-08-18T20:21:37.302+0000] {subprocess.py:93} INFO -     os.makedirs(target, exist_ok=True)
[2025-08-18T20:21:37.304+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.8/os.py", line 213, in makedirs
[2025-08-18T20:21:37.309+0000] {subprocess.py:93} INFO -     makedirs(head, exist_ok=exist_ok)
[2025-08-18T20:21:37.310+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.8/os.py", line 213, in makedirs
[2025-08-18T20:21:37.312+0000] {subprocess.py:93} INFO -     makedirs(head, exist_ok=exist_ok)
[2025-08-18T20:21:37.313+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.8/os.py", line 213, in makedirs
[2025-08-18T20:21:37.314+0000] {subprocess.py:93} INFO -     makedirs(head, exist_ok=exist_ok)
[2025-08-18T20:21:37.315+0000] {subprocess.py:93} INFO -   [Previous line repeated 7 more times]
[2025-08-18T20:21:37.317+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.8/os.py", line 223, in makedirs
[2025-08-18T20:21:37.318+0000] {subprocess.py:93} INFO -     mkdir(name, mode)
[2025-08-18T20:21:37.319+0000] {subprocess.py:93} INFO - PermissionError: [Errno 13] Permission denied: '/C:'
[2025-08-18T20:21:38.111+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2025-08-18T20:21:38.134+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 212, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2025-08-18T20:21:38.140+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=customer_churn_pipeline, task_id=model_training, execution_date=20250818T202037, start_date=20250818T202115, end_date=20250818T202138
[2025-08-18T20:21:38.228+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 43 for task model_training (Bash command failed. The command returned a non-zero exit code 1.; 854)
[2025-08-18T20:21:38.255+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2025-08-18T20:21:38.297+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
