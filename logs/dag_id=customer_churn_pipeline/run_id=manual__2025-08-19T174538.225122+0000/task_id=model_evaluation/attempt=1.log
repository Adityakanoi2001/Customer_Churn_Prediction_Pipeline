[2025-08-19T17:46:44.106+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: customer_churn_pipeline.model_evaluation manual__2025-08-19T17:45:38.225122+00:00 [queued]>
[2025-08-19T17:46:44.122+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: customer_churn_pipeline.model_evaluation manual__2025-08-19T17:45:38.225122+00:00 [queued]>
[2025-08-19T17:46:44.123+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2025-08-19T17:46:44.149+0000] {taskinstance.py:2217} INFO - Executing <Task(BashOperator): model_evaluation> on 2025-08-19 17:45:38.225122+00:00
[2025-08-19T17:46:44.159+0000] {standard_task_runner.py:60} INFO - Started process 988 to run task
[2025-08-19T17:46:44.170+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'customer_churn_pipeline', 'model_evaluation', 'manual__2025-08-19T17:45:38.225122+00:00', '--job-id', '23', '--raw', '--subdir', 'DAGS_FOLDER/customer_churn_pipeline_dag.py', '--cfg-path', '/tmp/tmp_0w_5cfn']
[2025-08-19T17:46:44.175+0000] {standard_task_runner.py:88} INFO - Job 23: Subtask model_evaluation
[2025-08-19T17:46:44.593+0000] {task_command.py:423} INFO - Running <TaskInstance: customer_churn_pipeline.model_evaluation manual__2025-08-19T17:45:38.225122+00:00 [running]> on host dc08f7cf7bac
[2025-08-19T17:46:44.743+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='customer_churn_pipeline' AIRFLOW_CTX_TASK_ID='model_evaluation' AIRFLOW_CTX_EXECUTION_DATE='2025-08-19T17:45:38.225122+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-08-19T17:45:38.225122+00:00'
[2025-08-19T17:46:44.745+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-08-19T17:46:44.748+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /opt/***/Customer_Churn_Prediction_Pipeline && python src/model_evaluation.py']
[2025-08-19T17:46:44.774+0000] {subprocess.py:86} INFO - Output:
[2025-08-19T17:46:50.381+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:50,380 INFO Starting model evaluation...
[2025-08-19T17:46:50.477+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:50,476 INFO Model loaded from models/churn_model.pkl
[2025-08-19T17:46:50.478+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:50,477 INFO Loading data for evaluation...
[2025-08-19T17:46:50.479+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:50,478 INFO Connecting to SQLite DB at data/features/churn_features.db
[2025-08-19T17:46:50.498+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:50,497 INFO Available tables: ['churn_features']
[2025-08-19T17:46:50.836+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:50,835 INFO Retrieved 7032 rows and 36 columns from table churn_features
[2025-08-19T17:46:50.839+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:50,838 INFO Found target column 'Churn'. Processing...
[2025-08-19T17:46:50.840+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:50,839 INFO Raw target column stats:
[2025-08-19T17:46:50.841+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:50,840 INFO   - Type: float64
[2025-08-19T17:46:50.842+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:50,841 INFO   - Unique values: [-0.601663392508594, 1.6620589061112205]
[2025-08-19T17:46:50.845+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:50,844 INFO   - Value counts:
[2025-08-19T17:46:50.846+0000] {subprocess.py:93} INFO - -0.601663    5163
[2025-08-19T17:46:50.847+0000] {subprocess.py:93} INFO -  1.662059    1869
[2025-08-19T17:46:50.848+0000] {subprocess.py:93} INFO - Name: Churn, dtype: int64
[2025-08-19T17:46:50.849+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:50,846 INFO Original target values before normalization: -0.601663    5163
[2025-08-19T17:46:50.850+0000] {subprocess.py:93} INFO -  1.662059    1869
[2025-08-19T17:46:50.851+0000] {subprocess.py:93} INFO - Name: Churn, dtype: int64
[2025-08-19T17:46:50.853+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:50,847 INFO Original target dtype: float64
[2025-08-19T17:46:50.854+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:50,848 INFO Unique numeric values in target: [-0.601663392508594, 1.6620589061112205]
[2025-08-19T17:46:50.856+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:50,849 INFO Binary target with values [-0.601663392508594, 1.6620589061112205]. Mapping to (0,1).
[2025-08-19T17:46:50.857+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:50,851 INFO Mapped -0.601663392508594→0, 1.6620589061112205→1
[2025-08-19T17:46:50.858+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:50,853 INFO Final normalized target stats:
[2025-08-19T17:46:50.859+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:50,855 INFO   - Unique values: [0, 1]
[2025-08-19T17:46:50.860+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:50,857 INFO   - Value counts:
[2025-08-19T17:46:50.861+0000] {subprocess.py:93} INFO - 0    5163
[2025-08-19T17:46:50.862+0000] {subprocess.py:93} INFO - 1    1869
[2025-08-19T17:46:50.863+0000] {subprocess.py:93} INFO - Name: Churn, dtype: int64
[2025-08-19T17:46:50.864+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:50,858 INFO Features shape before dtype fix: (7032, 35), Target shape: (7032,)
[2025-08-19T17:46:50.885+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:50,884 INFO Features dtypes after fix:
[2025-08-19T17:46:50.887+0000] {subprocess.py:93} INFO - gender                                   float64
[2025-08-19T17:46:50.889+0000] {subprocess.py:93} INFO - SeniorCitizen                            float64
[2025-08-19T17:46:50.890+0000] {subprocess.py:93} INFO - Partner                                  float64
[2025-08-19T17:46:50.891+0000] {subprocess.py:93} INFO - Dependents                               float64
[2025-08-19T17:46:50.891+0000] {subprocess.py:93} INFO - tenure                                   float64
[2025-08-19T17:46:50.892+0000] {subprocess.py:93} INFO - PhoneService                             float64
[2025-08-19T17:46:50.893+0000] {subprocess.py:93} INFO - PaperlessBilling                         float64
[2025-08-19T17:46:50.894+0000] {subprocess.py:93} INFO - MonthlyCharges                           float64
[2025-08-19T17:46:50.895+0000] {subprocess.py:93} INFO - TotalCharges                             float64
[2025-08-19T17:46:50.896+0000] {subprocess.py:93} INFO - TotalChargesPerTenure                    float64
[2025-08-19T17:46:50.896+0000] {subprocess.py:93} INFO - MultipleLines_No phone service           float64
[2025-08-19T17:46:50.897+0000] {subprocess.py:93} INFO - MultipleLines_Yes                        float64
[2025-08-19T17:46:50.898+0000] {subprocess.py:93} INFO - InternetService_Fiber optic              float64
[2025-08-19T17:46:50.899+0000] {subprocess.py:93} INFO - InternetService_No                       float64
[2025-08-19T17:46:50.900+0000] {subprocess.py:93} INFO - OnlineSecurity_No internet service       float64
[2025-08-19T17:46:50.901+0000] {subprocess.py:93} INFO - OnlineSecurity_Yes                       float64
[2025-08-19T17:46:50.902+0000] {subprocess.py:93} INFO - OnlineBackup_No internet service         float64
[2025-08-19T17:46:50.903+0000] {subprocess.py:93} INFO - OnlineBackup_Yes                         float64
[2025-08-19T17:46:50.904+0000] {subprocess.py:93} INFO - DeviceProtection_No internet service     float64
[2025-08-19T17:46:50.905+0000] {subprocess.py:93} INFO - DeviceProtection_Yes                     float64
[2025-08-19T17:46:50.908+0000] {subprocess.py:93} INFO - TechSupport_No internet service          float64
[2025-08-19T17:46:50.910+0000] {subprocess.py:93} INFO - TechSupport_Yes                          float64
[2025-08-19T17:46:50.914+0000] {subprocess.py:93} INFO - StreamingTV_No internet service          float64
[2025-08-19T17:46:50.918+0000] {subprocess.py:93} INFO - StreamingTV_Yes                          float64
[2025-08-19T17:46:50.920+0000] {subprocess.py:93} INFO - StreamingMovies_No internet service      float64
[2025-08-19T17:46:50.921+0000] {subprocess.py:93} INFO - StreamingMovies_Yes                      float64
[2025-08-19T17:46:50.926+0000] {subprocess.py:93} INFO - Contract_One year                        float64
[2025-08-19T17:46:50.928+0000] {subprocess.py:93} INFO - Contract_Two year                        float64
[2025-08-19T17:46:50.929+0000] {subprocess.py:93} INFO - PaymentMethod_Credit card (automatic)    float64
[2025-08-19T17:46:50.930+0000] {subprocess.py:93} INFO - PaymentMethod_Electronic check           float64
[2025-08-19T17:46:50.931+0000] {subprocess.py:93} INFO - PaymentMethod_Mailed check               float64
[2025-08-19T17:46:50.934+0000] {subprocess.py:93} INFO - TenureGroup_13-24                        float64
[2025-08-19T17:46:50.935+0000] {subprocess.py:93} INFO - TenureGroup_25-48                        float64
[2025-08-19T17:46:50.936+0000] {subprocess.py:93} INFO - TenureGroup_49-60                        float64
[2025-08-19T17:46:50.937+0000] {subprocess.py:93} INFO - TenureGroup_61+                          float64
[2025-08-19T17:46:50.945+0000] {subprocess.py:93} INFO - dtype: object
[2025-08-19T17:46:50.946+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:50,885 INFO Data loaded: 7032 samples, 35 features
[2025-08-19T17:46:50.950+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:50,887 INFO Classes in evaluation data: [0 1]
[2025-08-19T17:46:50.951+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:50,896 INFO Making predictions on test set...
[2025-08-19T17:46:50.952+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:50,910 INFO Calculating evaluation metrics...
[2025-08-19T17:46:51.000+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:50,999 INFO Creating evaluation plots...
[2025-08-19T17:46:51.805+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:51,803 INFO Confusion matrix saved to evaluation/confusion_matrix.png
[2025-08-19T17:46:52.610+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:52,609 INFO ROC curve saved to evaluation/roc_curve.png
[2025-08-19T17:46:53.341+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:53,340 INFO Precision-Recall curve saved to evaluation/precision_recall_curve.png
[2025-08-19T17:46:54.627+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:54,626 INFO Feature importance plot saved to evaluation/feature_importance.png
[2025-08-19T17:46:54.629+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:54,627 INFO Performing cross-validation...
[2025-08-19T17:46:54.630+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:54,628 INFO Performing cross-validation...
[2025-08-19T17:46:58.988+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:58,986 INFO ACCURACY: 0.7470 (+/- 0.0077)
[2025-08-19T17:46:58.990+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:58,987 INFO PRECISION: 0.5155 (+/- 0.0099)
[2025-08-19T17:46:58.992+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:58,989 INFO RECALL: 0.8010 (+/- 0.0385)
[2025-08-19T17:46:58.994+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:58,991 INFO F1: 0.6272 (+/- 0.0137)
[2025-08-19T17:46:58.995+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:58,992 INFO ROC_AUC: 0.8446 (+/- 0.0098)
[2025-08-19T17:46:58.996+0000] {subprocess.py:93} INFO - 2025-08-19 17:46:58,993 INFO Loaded best run ID: 758f77ef4c794795bdfdff4c02503bcc
[2025-08-19T17:47:02.489+0000] {subprocess.py:93} INFO - 2025-08-19 17:47:02,488 INFO Evaluation results logged to MLflow
[2025-08-19T17:47:02.682+0000] {subprocess.py:93} INFO - 2025-08-19 17:47:02,682 INFO Evaluation report saved to evaluation/evaluation_report.md
[2025-08-19T17:47:02.683+0000] {subprocess.py:93} INFO - 2025-08-19 17:47:02,682 INFO ==================================================
[2025-08-19T17:47:02.684+0000] {subprocess.py:93} INFO - 2025-08-19 17:47:02,683 INFO MODEL EVALUATION COMPLETE!
[2025-08-19T17:47:02.686+0000] {subprocess.py:93} INFO - 2025-08-19 17:47:02,683 INFO ==================================================
[2025-08-19T17:47:02.687+0000] {subprocess.py:93} INFO - 2025-08-19 17:47:02,684 INFO Test Accuracy: 0.7306
[2025-08-19T17:47:02.688+0000] {subprocess.py:93} INFO - 2025-08-19 17:47:02,684 INFO Test Precision: 0.4958
[2025-08-19T17:47:02.689+0000] {subprocess.py:93} INFO - 2025-08-19 17:47:02,686 INFO Test Recall: 0.7807
[2025-08-19T17:47:02.690+0000] {subprocess.py:93} INFO - 2025-08-19 17:47:02,687 INFO Test F1-Score: 0.6064
[2025-08-19T17:47:02.691+0000] {subprocess.py:93} INFO - 2025-08-19 17:47:02,687 INFO Test ROC-AUC: 0.8307
[2025-08-19T17:47:02.692+0000] {subprocess.py:93} INFO - 2025-08-19 17:47:02,688 INFO Evaluation report: evaluation/evaluation_report.md
[2025-08-19T17:47:02.693+0000] {subprocess.py:93} INFO - 2025-08-19 17:47:02,688 INFO ==================================================
[2025-08-19T17:47:03.150+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2025-08-19T17:47:03.212+0000] {taskinstance.py:1149} INFO - Marking task as SUCCESS. dag_id=customer_churn_pipeline, task_id=model_evaluation, execution_date=20250819T174538, start_date=20250819T174644, end_date=20250819T174703
[2025-08-19T17:47:03.281+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-08-19T17:47:03.323+0000] {taskinstance.py:3312} INFO - 1 downstream tasks scheduled from follow-on schedule check
