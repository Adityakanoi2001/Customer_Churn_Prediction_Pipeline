[2025-08-20T17:51:06.079+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: customer_churn_pipeline.model_evaluation manual__2025-08-20T17:47:18.117501+00:00 [queued]>
[2025-08-20T17:51:06.114+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: customer_churn_pipeline.model_evaluation manual__2025-08-20T17:47:18.117501+00:00 [queued]>
[2025-08-20T17:51:06.120+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2025-08-20T17:51:06.183+0000] {taskinstance.py:2217} INFO - Executing <Task(BashOperator): model_evaluation> on 2025-08-20 17:47:18.117501+00:00
[2025-08-20T17:51:06.193+0000] {standard_task_runner.py:60} INFO - Started process 438 to run task
[2025-08-20T17:51:06.221+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'customer_churn_pipeline', 'model_evaluation', 'manual__2025-08-20T17:47:18.117501+00:00', '--job-id', '15', '--raw', '--subdir', 'DAGS_FOLDER/customer_churn_pipeline_dag.py', '--cfg-path', '/tmp/tmp1k_pd82g']
[2025-08-20T17:51:06.233+0000] {standard_task_runner.py:88} INFO - Job 15: Subtask model_evaluation
[2025-08-20T17:51:06.412+0000] {task_command.py:423} INFO - Running <TaskInstance: customer_churn_pipeline.model_evaluation manual__2025-08-20T17:47:18.117501+00:00 [running]> on host bd9202be787f
[2025-08-20T17:51:06.705+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='customer_churn_pipeline' AIRFLOW_CTX_TASK_ID='model_evaluation' AIRFLOW_CTX_EXECUTION_DATE='2025-08-20T17:47:18.117501+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-08-20T17:47:18.117501+00:00'
[2025-08-20T17:51:06.708+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-08-20T17:51:06.717+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /opt/***/Customer_Churn_Prediction_Pipeline && python src/model_evaluation.py']
[2025-08-20T17:51:06.769+0000] {subprocess.py:86} INFO - Output:
[2025-08-20T17:51:19.948+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:19,947 INFO Starting model evaluation...
[2025-08-20T17:51:20.128+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:20,126 INFO Model loaded from models/churn_model.pkl
[2025-08-20T17:51:20.129+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:20,129 INFO Loading data for evaluation...
[2025-08-20T17:51:20.134+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:20,130 INFO Connecting to SQLite DB at data/features/churn_features.db
[2025-08-20T17:51:20.229+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:20,226 INFO Available tables: ['churn_features']
[2025-08-20T17:51:21.643+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:21,641 INFO Retrieved 7032 rows and 36 columns from table churn_features
[2025-08-20T17:51:21.651+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:21,650 INFO Found target column 'Churn'. Processing...
[2025-08-20T17:51:21.652+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:21,651 INFO Raw target column stats:
[2025-08-20T17:51:21.653+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:21,652 INFO   - Type: float64
[2025-08-20T17:51:21.654+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:21,653 INFO   - Unique values: [-0.601663392508594, 1.6620589061112205]
[2025-08-20T17:51:21.660+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:21,659 INFO   - Value counts:
[2025-08-20T17:51:21.661+0000] {subprocess.py:93} INFO - -0.601663    5163
[2025-08-20T17:51:21.662+0000] {subprocess.py:93} INFO -  1.662059    1869
[2025-08-20T17:51:21.662+0000] {subprocess.py:93} INFO - Name: Churn, dtype: int64
[2025-08-20T17:51:21.663+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:21,662 INFO Original target values before normalization: -0.601663    5163
[2025-08-20T17:51:21.665+0000] {subprocess.py:93} INFO -  1.662059    1869
[2025-08-20T17:51:21.666+0000] {subprocess.py:93} INFO - Name: Churn, dtype: int64
[2025-08-20T17:51:21.666+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:21,663 INFO Original target dtype: float64
[2025-08-20T17:51:21.667+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:21,665 INFO Unique numeric values in target: [-0.601663392508594, 1.6620589061112205]
[2025-08-20T17:51:21.668+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:21,666 INFO Binary target with values [-0.601663392508594, 1.6620589061112205]. Mapping to (0,1).
[2025-08-20T17:51:21.669+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:21,667 INFO Mapped -0.601663392508594→0, 1.6620589061112205→1
[2025-08-20T17:51:21.670+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:21,669 INFO Final normalized target stats:
[2025-08-20T17:51:21.671+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:21,670 INFO   - Unique values: [0, 1]
[2025-08-20T17:51:21.675+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:21,673 INFO   - Value counts:
[2025-08-20T17:51:21.679+0000] {subprocess.py:93} INFO - 0    5163
[2025-08-20T17:51:21.686+0000] {subprocess.py:93} INFO - 1    1869
[2025-08-20T17:51:21.687+0000] {subprocess.py:93} INFO - Name: Churn, dtype: int64
[2025-08-20T17:51:21.688+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:21,675 INFO Features shape before dtype fix: (7032, 35), Target shape: (7032,)
[2025-08-20T17:51:21.725+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:21,725 INFO Features dtypes after fix:
[2025-08-20T17:51:21.726+0000] {subprocess.py:93} INFO - gender                                   float64
[2025-08-20T17:51:21.728+0000] {subprocess.py:93} INFO - SeniorCitizen                            float64
[2025-08-20T17:51:21.731+0000] {subprocess.py:93} INFO - Partner                                  float64
[2025-08-20T17:51:21.734+0000] {subprocess.py:93} INFO - Dependents                               float64
[2025-08-20T17:51:21.735+0000] {subprocess.py:93} INFO - tenure                                   float64
[2025-08-20T17:51:21.736+0000] {subprocess.py:93} INFO - PhoneService                             float64
[2025-08-20T17:51:21.737+0000] {subprocess.py:93} INFO - PaperlessBilling                         float64
[2025-08-20T17:51:21.738+0000] {subprocess.py:93} INFO - MonthlyCharges                           float64
[2025-08-20T17:51:21.738+0000] {subprocess.py:93} INFO - TotalCharges                             float64
[2025-08-20T17:51:21.739+0000] {subprocess.py:93} INFO - TotalChargesPerTenure                    float64
[2025-08-20T17:51:21.740+0000] {subprocess.py:93} INFO - MultipleLines_No phone service           float64
[2025-08-20T17:51:21.741+0000] {subprocess.py:93} INFO - MultipleLines_Yes                        float64
[2025-08-20T17:51:21.742+0000] {subprocess.py:93} INFO - InternetService_Fiber optic              float64
[2025-08-20T17:51:21.742+0000] {subprocess.py:93} INFO - InternetService_No                       float64
[2025-08-20T17:51:21.743+0000] {subprocess.py:93} INFO - OnlineSecurity_No internet service       float64
[2025-08-20T17:51:21.744+0000] {subprocess.py:93} INFO - OnlineSecurity_Yes                       float64
[2025-08-20T17:51:21.744+0000] {subprocess.py:93} INFO - OnlineBackup_No internet service         float64
[2025-08-20T17:51:21.745+0000] {subprocess.py:93} INFO - OnlineBackup_Yes                         float64
[2025-08-20T17:51:21.746+0000] {subprocess.py:93} INFO - DeviceProtection_No internet service     float64
[2025-08-20T17:51:21.750+0000] {subprocess.py:93} INFO - DeviceProtection_Yes                     float64
[2025-08-20T17:51:21.753+0000] {subprocess.py:93} INFO - TechSupport_No internet service          float64
[2025-08-20T17:51:21.755+0000] {subprocess.py:93} INFO - TechSupport_Yes                          float64
[2025-08-20T17:51:21.758+0000] {subprocess.py:93} INFO - StreamingTV_No internet service          float64
[2025-08-20T17:51:21.760+0000] {subprocess.py:93} INFO - StreamingTV_Yes                          float64
[2025-08-20T17:51:21.778+0000] {subprocess.py:93} INFO - StreamingMovies_No internet service      float64
[2025-08-20T17:51:21.782+0000] {subprocess.py:93} INFO - StreamingMovies_Yes                      float64
[2025-08-20T17:51:21.785+0000] {subprocess.py:93} INFO - Contract_One year                        float64
[2025-08-20T17:51:21.799+0000] {subprocess.py:93} INFO - Contract_Two year                        float64
[2025-08-20T17:51:21.800+0000] {subprocess.py:93} INFO - PaymentMethod_Credit card (automatic)    float64
[2025-08-20T17:51:21.808+0000] {subprocess.py:93} INFO - PaymentMethod_Electronic check           float64
[2025-08-20T17:51:21.811+0000] {subprocess.py:93} INFO - PaymentMethod_Mailed check               float64
[2025-08-20T17:51:21.816+0000] {subprocess.py:93} INFO - TenureGroup_13-24                        float64
[2025-08-20T17:51:21.818+0000] {subprocess.py:93} INFO - TenureGroup_25-48                        float64
[2025-08-20T17:51:21.820+0000] {subprocess.py:93} INFO - TenureGroup_49-60                        float64
[2025-08-20T17:51:21.836+0000] {subprocess.py:93} INFO - TenureGroup_61+                          float64
[2025-08-20T17:51:21.888+0000] {subprocess.py:93} INFO - dtype: object
[2025-08-20T17:51:21.889+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:21,725 INFO Data loaded: 7032 samples, 35 features
[2025-08-20T17:51:21.890+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:21,727 INFO Classes in evaluation data: [0 1]
[2025-08-20T17:51:21.919+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:21,745 INFO Making predictions on test set...
[2025-08-20T17:51:21.928+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:21,793 INFO Calculating evaluation metrics...
[2025-08-20T17:51:22.004+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:21,998 INFO Creating evaluation plots...
[2025-08-20T17:51:24.928+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:24,921 INFO Confusion matrix saved to evaluation/confusion_matrix.png
[2025-08-20T17:51:24.308+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:24,296 INFO ROC curve saved to evaluation/roc_curve.png
[2025-08-20T17:51:26.691+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:26,679 INFO Precision-Recall curve saved to evaluation/precision_recall_curve.png
[2025-08-20T17:51:33.712+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:33,678 INFO Feature importance plot saved to evaluation/feature_importance.png
[2025-08-20T17:51:33.750+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:33,710 INFO Performing cross-validation...
[2025-08-20T17:51:33.761+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:33,728 INFO Performing cross-validation...
[2025-08-20T17:52:31.403+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:31,400 INFO ACCURACY: 0.7470 (+/- 0.0077)
[2025-08-20T17:52:31.427+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:31,408 INFO PRECISION: 0.5155 (+/- 0.0099)
[2025-08-20T17:52:31.435+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:31,426 INFO RECALL: 0.8010 (+/- 0.0385)
[2025-08-20T17:52:31.447+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:31,433 INFO F1: 0.6272 (+/- 0.0137)
[2025-08-20T17:52:31.456+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:31,446 INFO ROC_AUC: 0.8446 (+/- 0.0098)
[2025-08-20T17:52:31.470+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:31,464 INFO Loaded best run ID: d58cbb1df47a44b0a994ac020152d04d
[2025-08-20T17:52:37.960+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:37,951 INFO Evaluation results logged to MLflow
[2025-08-20T17:52:38.150+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:38,149 INFO Evaluation report saved to evaluation/evaluation_report.md
[2025-08-20T17:52:38.152+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:38,150 INFO ==================================================
[2025-08-20T17:52:38.153+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:38,152 INFO MODEL EVALUATION COMPLETE!
[2025-08-20T17:52:38.156+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:38,152 INFO ==================================================
[2025-08-20T17:52:38.159+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:38,153 INFO Test Accuracy: 0.7306
[2025-08-20T17:52:38.160+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:38,154 INFO Test Precision: 0.4958
[2025-08-20T17:52:38.161+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:38,156 INFO Test Recall: 0.7807
[2025-08-20T17:52:38.163+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:38,159 INFO Test F1-Score: 0.6064
[2025-08-20T17:52:38.164+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:38,159 INFO Test ROC-AUC: 0.8307
[2025-08-20T17:52:38.165+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:38,160 INFO Evaluation report: evaluation/evaluation_report.md
[2025-08-20T17:52:38.166+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:38,160 INFO ==================================================
[2025-08-20T17:52:39.333+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2025-08-20T17:52:39.541+0000] {taskinstance.py:1149} INFO - Marking task as SUCCESS. dag_id=customer_churn_pipeline, task_id=model_evaluation, execution_date=20250820T174718, start_date=20250820T175106, end_date=20250820T175239
[2025-08-20T17:52:39.682+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-08-20T17:52:39.890+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
