[2025-08-21T05:14:10.786+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: customer_churn_pipeline.model_evaluation scheduled__2025-08-20T00:00:00+00:00 [queued]>
[2025-08-21T05:14:10.824+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: customer_churn_pipeline.model_evaluation scheduled__2025-08-20T00:00:00+00:00 [queued]>
[2025-08-21T05:14:10.825+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2025-08-21T05:14:10.881+0000] {taskinstance.py:2217} INFO - Executing <Task(BashOperator): model_evaluation> on 2025-08-20 00:00:00+00:00
[2025-08-21T05:14:10.893+0000] {standard_task_runner.py:60} INFO - Started process 323 to run task
[2025-08-21T05:14:10.905+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'customer_churn_pipeline', 'model_evaluation', 'scheduled__2025-08-20T00:00:00+00:00', '--job-id', '27', '--raw', '--subdir', 'DAGS_FOLDER/customer_churn_pipeline_dag.py', '--cfg-path', '/tmp/tmpe4aqlbl2']
[2025-08-21T05:14:10.922+0000] {standard_task_runner.py:88} INFO - Job 27: Subtask model_evaluation
[2025-08-21T05:14:11.071+0000] {task_command.py:423} INFO - Running <TaskInstance: customer_churn_pipeline.model_evaluation scheduled__2025-08-20T00:00:00+00:00 [running]> on host bd9202be787f
[2025-08-21T05:14:11.301+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='customer_churn_pipeline' AIRFLOW_CTX_TASK_ID='model_evaluation' AIRFLOW_CTX_EXECUTION_DATE='2025-08-20T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-08-20T00:00:00+00:00'
[2025-08-21T05:14:11.309+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-08-21T05:14:11.320+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /opt/***/Customer_Churn_Prediction_Pipeline && python src/model_evaluation.py']
[2025-08-21T05:14:11.349+0000] {subprocess.py:86} INFO - Output:
[2025-08-21T05:14:22.156+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:22,153 INFO Starting model evaluation...
[2025-08-21T05:14:22.238+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:22,238 INFO Model loaded from models/churn_model.pkl
[2025-08-21T05:14:22.239+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:22,238 INFO Loading data for evaluation...
[2025-08-21T05:14:22.240+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:22,239 INFO Connecting to SQLite DB at data/features/churn_features.db
[2025-08-21T05:14:22.263+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:22,261 INFO Available tables: ['churn_features']
[2025-08-21T05:14:22.867+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:22,867 INFO Retrieved 7032 rows and 36 columns from table churn_features
[2025-08-21T05:14:22.870+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:22,869 INFO Found target column 'Churn'. Processing...
[2025-08-21T05:14:22.875+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:22,870 INFO Raw target column stats:
[2025-08-21T05:14:22.877+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:22,873 INFO   - Type: float64
[2025-08-21T05:14:22.880+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:22,875 INFO   - Unique values: [-0.601663392508594, 1.6620589061112205]
[2025-08-21T05:14:22.884+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:22,883 INFO   - Value counts:
[2025-08-21T05:14:22.885+0000] {subprocess.py:93} INFO - -0.601663    5163
[2025-08-21T05:14:22.886+0000] {subprocess.py:93} INFO -  1.662059    1869
[2025-08-21T05:14:22.887+0000] {subprocess.py:93} INFO - Name: Churn, dtype: int64
[2025-08-21T05:14:22.888+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:22,886 INFO Original target values before normalization: -0.601663    5163
[2025-08-21T05:14:22.889+0000] {subprocess.py:93} INFO -  1.662059    1869
[2025-08-21T05:14:22.890+0000] {subprocess.py:93} INFO - Name: Churn, dtype: int64
[2025-08-21T05:14:22.893+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:22,886 INFO Original target dtype: float64
[2025-08-21T05:14:22.904+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:22,887 INFO Unique numeric values in target: [-0.601663392508594, 1.6620589061112205]
[2025-08-21T05:14:22.922+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:22,888 INFO Binary target with values [-0.601663392508594, 1.6620589061112205]. Mapping to (0,1).
[2025-08-21T05:14:22.923+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:22,889 INFO Mapped -0.601663392508594→0, 1.6620589061112205→1
[2025-08-21T05:14:22.924+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:22,895 INFO Final normalized target stats:
[2025-08-21T05:14:22.925+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:22,906 INFO   - Unique values: [0, 1]
[2025-08-21T05:14:22.927+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:22,923 INFO   - Value counts:
[2025-08-21T05:14:22.936+0000] {subprocess.py:93} INFO - 0    5163
[2025-08-21T05:14:22.939+0000] {subprocess.py:93} INFO - 1    1869
[2025-08-21T05:14:22.941+0000] {subprocess.py:93} INFO - Name: Churn, dtype: int64
[2025-08-21T05:14:22.942+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:22,924 INFO Features shape before dtype fix: (7032, 35), Target shape: (7032,)
[2025-08-21T05:14:22.983+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:22,980 INFO Features dtypes after fix:
[2025-08-21T05:14:22.987+0000] {subprocess.py:93} INFO - gender                                   float64
[2025-08-21T05:14:22.990+0000] {subprocess.py:93} INFO - SeniorCitizen                            float64
[2025-08-21T05:14:22.991+0000] {subprocess.py:93} INFO - Partner                                  float64
[2025-08-21T05:14:22.992+0000] {subprocess.py:93} INFO - Dependents                               float64
[2025-08-21T05:14:22.993+0000] {subprocess.py:93} INFO - tenure                                   float64
[2025-08-21T05:14:22.994+0000] {subprocess.py:93} INFO - PhoneService                             float64
[2025-08-21T05:14:22.995+0000] {subprocess.py:93} INFO - PaperlessBilling                         float64
[2025-08-21T05:14:22.996+0000] {subprocess.py:93} INFO - MonthlyCharges                           float64
[2025-08-21T05:14:22.997+0000] {subprocess.py:93} INFO - TotalCharges                             float64
[2025-08-21T05:14:22.998+0000] {subprocess.py:93} INFO - TotalChargesPerTenure                    float64
[2025-08-21T05:14:22.999+0000] {subprocess.py:93} INFO - MultipleLines_No phone service           float64
[2025-08-21T05:14:23.001+0000] {subprocess.py:93} INFO - MultipleLines_Yes                        float64
[2025-08-21T05:14:23.006+0000] {subprocess.py:93} INFO - InternetService_Fiber optic              float64
[2025-08-21T05:14:23.007+0000] {subprocess.py:93} INFO - InternetService_No                       float64
[2025-08-21T05:14:23.008+0000] {subprocess.py:93} INFO - OnlineSecurity_No internet service       float64
[2025-08-21T05:14:23.009+0000] {subprocess.py:93} INFO - OnlineSecurity_Yes                       float64
[2025-08-21T05:14:23.011+0000] {subprocess.py:93} INFO - OnlineBackup_No internet service         float64
[2025-08-21T05:14:23.011+0000] {subprocess.py:93} INFO - OnlineBackup_Yes                         float64
[2025-08-21T05:14:23.012+0000] {subprocess.py:93} INFO - DeviceProtection_No internet service     float64
[2025-08-21T05:14:23.013+0000] {subprocess.py:93} INFO - DeviceProtection_Yes                     float64
[2025-08-21T05:14:23.014+0000] {subprocess.py:93} INFO - TechSupport_No internet service          float64
[2025-08-21T05:14:23.018+0000] {subprocess.py:93} INFO - TechSupport_Yes                          float64
[2025-08-21T05:14:23.024+0000] {subprocess.py:93} INFO - StreamingTV_No internet service          float64
[2025-08-21T05:14:23.027+0000] {subprocess.py:93} INFO - StreamingTV_Yes                          float64
[2025-08-21T05:14:23.030+0000] {subprocess.py:93} INFO - StreamingMovies_No internet service      float64
[2025-08-21T05:14:23.032+0000] {subprocess.py:93} INFO - StreamingMovies_Yes                      float64
[2025-08-21T05:14:23.034+0000] {subprocess.py:93} INFO - Contract_One year                        float64
[2025-08-21T05:14:23.037+0000] {subprocess.py:93} INFO - Contract_Two year                        float64
[2025-08-21T05:14:23.045+0000] {subprocess.py:93} INFO - PaymentMethod_Credit card (automatic)    float64
[2025-08-21T05:14:23.047+0000] {subprocess.py:93} INFO - PaymentMethod_Electronic check           float64
[2025-08-21T05:14:23.048+0000] {subprocess.py:93} INFO - PaymentMethod_Mailed check               float64
[2025-08-21T05:14:23.053+0000] {subprocess.py:93} INFO - TenureGroup_13-24                        float64
[2025-08-21T05:14:23.070+0000] {subprocess.py:93} INFO - TenureGroup_25-48                        float64
[2025-08-21T05:14:23.072+0000] {subprocess.py:93} INFO - TenureGroup_49-60                        float64
[2025-08-21T05:14:23.074+0000] {subprocess.py:93} INFO - TenureGroup_61+                          float64
[2025-08-21T05:14:23.081+0000] {subprocess.py:93} INFO - dtype: object
[2025-08-21T05:14:23.085+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:22,983 INFO Data loaded: 7032 samples, 35 features
[2025-08-21T05:14:23.096+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:22,989 INFO Classes in evaluation data: [0 1]
[2025-08-21T05:14:23.101+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:23,010 INFO Making predictions on test set...
[2025-08-21T05:14:23.105+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:23,031 INFO Calculating evaluation metrics...
[2025-08-21T05:14:23.139+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:23,138 INFO Creating evaluation plots...
[2025-08-21T05:14:24.624+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:24,620 INFO Confusion matrix saved to evaluation/confusion_matrix.png
[2025-08-21T05:14:27.018+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:27,017 INFO ROC curve saved to evaluation/roc_curve.png
[2025-08-21T05:14:28.740+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:28,739 INFO Precision-Recall curve saved to evaluation/precision_recall_curve.png
[2025-08-21T05:14:30.410+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:30,406 INFO Feature importance plot saved to evaluation/feature_importance.png
[2025-08-21T05:14:30.411+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:30,410 INFO Performing cross-validation...
[2025-08-21T05:14:30.412+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:30,410 INFO Performing cross-validation...
[2025-08-21T05:14:49.642+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:49,636 INFO ACCURACY: 0.7470 (+/- 0.0077)
[2025-08-21T05:14:49.648+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:49,637 INFO PRECISION: 0.5155 (+/- 0.0099)
[2025-08-21T05:14:49.650+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:49,648 INFO RECALL: 0.8010 (+/- 0.0385)
[2025-08-21T05:14:49.653+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:49,652 INFO F1: 0.6272 (+/- 0.0137)
[2025-08-21T05:14:49.660+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:49,653 INFO ROC_AUC: 0.8446 (+/- 0.0098)
[2025-08-21T05:14:49.663+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:49,663 INFO Loaded best run ID: 054959b9454048069c7dcb0c15080c16
[2025-08-21T05:14:55.042+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:55,042 INFO Evaluation results logged to MLflow
[2025-08-21T05:14:55.456+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:55,453 INFO Evaluation report saved to evaluation/evaluation_report.md
[2025-08-21T05:14:55.460+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:55,456 INFO ==================================================
[2025-08-21T05:14:55.462+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:55,458 INFO MODEL EVALUATION COMPLETE!
[2025-08-21T05:14:55.464+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:55,460 INFO ==================================================
[2025-08-21T05:14:55.468+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:55,461 INFO Test Accuracy: 0.7306
[2025-08-21T05:14:55.471+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:55,462 INFO Test Precision: 0.4958
[2025-08-21T05:14:55.473+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:55,464 INFO Test Recall: 0.7807
[2025-08-21T05:14:55.474+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:55,464 INFO Test F1-Score: 0.6064
[2025-08-21T05:14:55.475+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:55,469 INFO Test ROC-AUC: 0.8307
[2025-08-21T05:14:55.476+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:55,472 INFO Evaluation report: evaluation/evaluation_report.md
[2025-08-21T05:14:55.477+0000] {subprocess.py:93} INFO - 2025-08-21 05:14:55,473 INFO ==================================================
[2025-08-21T05:14:56.690+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2025-08-21T05:14:56.762+0000] {taskinstance.py:1149} INFO - Marking task as SUCCESS. dag_id=customer_churn_pipeline, task_id=model_evaluation, execution_date=20250820T000000, start_date=20250821T051410, end_date=20250821T051456
[2025-08-21T05:14:56.845+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-08-21T05:14:56.909+0000] {taskinstance.py:3312} INFO - 1 downstream tasks scheduled from follow-on schedule check
