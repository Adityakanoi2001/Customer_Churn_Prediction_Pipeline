[2025-08-18T21:23:14.172+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: customer_churn_pipeline.model_evaluation manual__2025-08-18T21:22:19.969882+00:00 [queued]>
[2025-08-18T21:23:14.184+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: customer_churn_pipeline.model_evaluation manual__2025-08-18T21:22:19.969882+00:00 [queued]>
[2025-08-18T21:23:14.186+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2025-08-18T21:23:14.200+0000] {taskinstance.py:2217} INFO - Executing <Task(BashOperator): model_evaluation> on 2025-08-18 21:22:19.969882+00:00
[2025-08-18T21:23:14.209+0000] {standard_task_runner.py:60} INFO - Started process 2558 to run task
[2025-08-18T21:23:14.212+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'customer_churn_pipeline', 'model_evaluation', 'manual__2025-08-18T21:22:19.969882+00:00', '--job-id', '54', '--raw', '--subdir', 'DAGS_FOLDER/customer_churn_pipeline_dag.py', '--cfg-path', '/tmp/tmpyj4tgt9a']
[2025-08-18T21:23:14.215+0000] {standard_task_runner.py:88} INFO - Job 54: Subtask model_evaluation
[2025-08-18T21:23:14.277+0000] {task_command.py:423} INFO - Running <TaskInstance: customer_churn_pipeline.model_evaluation manual__2025-08-18T21:22:19.969882+00:00 [running]> on host 2e4674d7276b
[2025-08-18T21:23:14.374+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='customer_churn_pipeline' AIRFLOW_CTX_TASK_ID='model_evaluation' AIRFLOW_CTX_EXECUTION_DATE='2025-08-18T21:22:19.969882+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-08-18T21:22:19.969882+00:00'
[2025-08-18T21:23:14.377+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-08-18T21:23:14.379+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /opt/***/Customer_Churn_Prediction_Pipeline && python src/model_evaluation.py']
[2025-08-18T21:23:14.389+0000] {subprocess.py:86} INFO - Output:
[2025-08-18T21:23:17.077+0000] {subprocess.py:93} INFO - 2025-08-18 21:23:17,076 INFO Starting model evaluation...
[2025-08-18T21:23:17.117+0000] {subprocess.py:93} INFO - 2025-08-18 21:23:17,116 INFO Model loaded from models/churn_model.pkl
[2025-08-18T21:23:17.118+0000] {subprocess.py:93} INFO - 2025-08-18 21:23:17,117 INFO Loading data for evaluation...
[2025-08-18T21:23:17.119+0000] {subprocess.py:93} INFO - 2025-08-18 21:23:17,117 INFO Connecting to SQLite DB at data/features/churn_features.db
[2025-08-18T21:23:17.135+0000] {subprocess.py:93} INFO - 2025-08-18 21:23:17,134 INFO Available tables: ['churn_features']
[2025-08-18T21:23:17.382+0000] {subprocess.py:93} INFO - 2025-08-18 21:23:17,380 INFO Retrieved 7032 rows and 36 columns from table churn_features
[2025-08-18T21:23:17.386+0000] {subprocess.py:93} INFO - 2025-08-18 21:23:17,385 INFO Found target column 'Churn'. Processing...
[2025-08-18T21:23:17.387+0000] {subprocess.py:93} INFO - 2025-08-18 21:23:17,386 INFO Raw target column stats:
[2025-08-18T21:23:17.387+0000] {subprocess.py:93} INFO - 2025-08-18 21:23:17,386 INFO   - Type: float64
[2025-08-18T21:23:17.388+0000] {subprocess.py:93} INFO - 2025-08-18 21:23:17,387 INFO   - Unique values: [-0.601663392508594, 1.6620589061112205]
[2025-08-18T21:23:17.390+0000] {subprocess.py:93} INFO - 2025-08-18 21:23:17,389 INFO   - Value counts:
[2025-08-18T21:23:17.390+0000] {subprocess.py:93} INFO - -0.601663    5163
[2025-08-18T21:23:17.391+0000] {subprocess.py:93} INFO -  1.662059    1869
[2025-08-18T21:23:17.392+0000] {subprocess.py:93} INFO - Name: Churn, dtype: int64
[2025-08-18T21:23:17.393+0000] {subprocess.py:93} INFO - 2025-08-18 21:23:17,390 INFO Original target values before normalization: -0.601663    5163
[2025-08-18T21:23:17.393+0000] {subprocess.py:93} INFO -  1.662059    1869
[2025-08-18T21:23:17.394+0000] {subprocess.py:93} INFO - Name: Churn, dtype: int64
[2025-08-18T21:23:17.394+0000] {subprocess.py:93} INFO - 2025-08-18 21:23:17,391 INFO Original target dtype: float64
[2025-08-18T21:23:17.395+0000] {subprocess.py:93} INFO - 2025-08-18 21:23:17,391 INFO Unique numeric values in target: [-0.601663392508594, 1.6620589061112205]
[2025-08-18T21:23:17.396+0000] {subprocess.py:93} INFO - 2025-08-18 21:23:17,392 INFO Binary target with values [-0.601663392508594, 1.6620589061112205]. Mapping to (0,1).
[2025-08-18T21:23:17.396+0000] {subprocess.py:93} INFO - 2025-08-18 21:23:17,393 INFO Mapped -0.601663392508594→0, 1.6620589061112205→1
[2025-08-18T21:23:17.397+0000] {subprocess.py:93} INFO - 2025-08-18 21:23:17,395 INFO Final normalized target stats:
[2025-08-18T21:23:17.397+0000] {subprocess.py:93} INFO - 2025-08-18 21:23:17,395 INFO   - Unique values: [0, 1]
[2025-08-18T21:23:17.398+0000] {subprocess.py:93} INFO - 2025-08-18 21:23:17,397 INFO   - Value counts:
[2025-08-18T21:23:17.399+0000] {subprocess.py:93} INFO - 0    5163
[2025-08-18T21:23:17.400+0000] {subprocess.py:93} INFO - 1    1869
[2025-08-18T21:23:17.400+0000] {subprocess.py:93} INFO - Name: Churn, dtype: int64
[2025-08-18T21:23:17.401+0000] {subprocess.py:93} INFO - 2025-08-18 21:23:17,397 INFO Features shape before dtype fix: (7032, 35), Target shape: (7032,)
[2025-08-18T21:23:17.411+0000] {subprocess.py:93} INFO - 2025-08-18 21:23:17,409 INFO Features dtypes after fix:
[2025-08-18T21:23:17.412+0000] {subprocess.py:93} INFO - gender                                   float64
[2025-08-18T21:23:17.413+0000] {subprocess.py:93} INFO - SeniorCitizen                            float64
[2025-08-18T21:23:17.413+0000] {subprocess.py:93} INFO - Partner                                  float64
[2025-08-18T21:23:17.414+0000] {subprocess.py:93} INFO - Dependents                               float64
[2025-08-18T21:23:17.415+0000] {subprocess.py:93} INFO - tenure                                   float64
[2025-08-18T21:23:17.416+0000] {subprocess.py:93} INFO - PhoneService                             float64
[2025-08-18T21:23:17.416+0000] {subprocess.py:93} INFO - PaperlessBilling                         float64
[2025-08-18T21:23:17.417+0000] {subprocess.py:93} INFO - MonthlyCharges                           float64
[2025-08-18T21:23:17.417+0000] {subprocess.py:93} INFO - TotalCharges                             float64
[2025-08-18T21:23:17.418+0000] {subprocess.py:93} INFO - TotalChargesPerTenure                    float64
[2025-08-18T21:23:17.419+0000] {subprocess.py:93} INFO - MultipleLines_No phone service           float64
[2025-08-18T21:23:17.420+0000] {subprocess.py:93} INFO - MultipleLines_Yes                        float64
[2025-08-18T21:23:17.421+0000] {subprocess.py:93} INFO - InternetService_Fiber optic              float64
[2025-08-18T21:23:17.421+0000] {subprocess.py:93} INFO - InternetService_No                       float64
[2025-08-18T21:23:17.422+0000] {subprocess.py:93} INFO - OnlineSecurity_No internet service       float64
[2025-08-18T21:23:17.423+0000] {subprocess.py:93} INFO - OnlineSecurity_Yes                       float64
[2025-08-18T21:23:17.424+0000] {subprocess.py:93} INFO - OnlineBackup_No internet service         float64
[2025-08-18T21:23:17.425+0000] {subprocess.py:93} INFO - OnlineBackup_Yes                         float64
[2025-08-18T21:23:17.425+0000] {subprocess.py:93} INFO - DeviceProtection_No internet service     float64
[2025-08-18T21:23:17.436+0000] {subprocess.py:93} INFO - DeviceProtection_Yes                     float64
[2025-08-18T21:23:17.439+0000] {subprocess.py:93} INFO - TechSupport_No internet service          float64
[2025-08-18T21:23:17.448+0000] {subprocess.py:93} INFO - TechSupport_Yes                          float64
[2025-08-18T21:23:17.459+0000] {subprocess.py:93} INFO - StreamingTV_No internet service          float64
[2025-08-18T21:23:17.471+0000] {subprocess.py:93} INFO - StreamingTV_Yes                          float64
[2025-08-18T21:23:17.485+0000] {subprocess.py:93} INFO - StreamingMovies_No internet service      float64
[2025-08-18T21:23:17.491+0000] {subprocess.py:93} INFO - StreamingMovies_Yes                      float64
[2025-08-18T21:23:17.492+0000] {subprocess.py:93} INFO - Contract_One year                        float64
[2025-08-18T21:23:17.493+0000] {subprocess.py:93} INFO - Contract_Two year                        float64
[2025-08-18T21:23:17.495+0000] {subprocess.py:93} INFO - PaymentMethod_Credit card (automatic)    float64
[2025-08-18T21:23:17.510+0000] {subprocess.py:93} INFO - PaymentMethod_Electronic check           float64
[2025-08-18T21:23:17.511+0000] {subprocess.py:93} INFO - PaymentMethod_Mailed check               float64
[2025-08-18T21:23:17.525+0000] {subprocess.py:93} INFO - TenureGroup_13-24                        float64
[2025-08-18T21:23:17.526+0000] {subprocess.py:93} INFO - TenureGroup_25-48                        float64
[2025-08-18T21:23:17.527+0000] {subprocess.py:93} INFO - TenureGroup_49-60                        float64
[2025-08-18T21:23:17.528+0000] {subprocess.py:93} INFO - TenureGroup_61+                          float64
[2025-08-18T21:23:17.541+0000] {subprocess.py:93} INFO - dtype: object
[2025-08-18T21:23:17.543+0000] {subprocess.py:93} INFO - 2025-08-18 21:23:17,411 INFO Data loaded: 7032 samples, 35 features
[2025-08-18T21:23:17.543+0000] {subprocess.py:93} INFO - 2025-08-18 21:23:17,412 INFO Classes in evaluation data: [0 1]
[2025-08-18T21:23:17.544+0000] {subprocess.py:93} INFO - 2025-08-18 21:23:17,421 INFO Making predictions on test set...
[2025-08-18T21:23:17.545+0000] {subprocess.py:93} INFO - 2025-08-18 21:23:17,456 INFO Calculating evaluation metrics...
[2025-08-18T21:23:17.546+0000] {subprocess.py:93} INFO - 2025-08-18 21:23:17,508 INFO Creating evaluation plots...
[2025-08-18T21:23:17.935+0000] {subprocess.py:93} INFO - 2025-08-18 21:23:17,934 INFO Confusion matrix saved to evaluation/confusion_matrix.png
[2025-08-18T21:23:18.415+0000] {subprocess.py:93} INFO - 2025-08-18 21:23:18,414 INFO ROC curve saved to evaluation/roc_curve.png
[2025-08-18T21:23:18.825+0000] {subprocess.py:93} INFO - 2025-08-18 21:23:18,823 INFO Precision-Recall curve saved to evaluation/precision_recall_curve.png
[2025-08-18T21:23:19.427+0000] {subprocess.py:93} INFO - 2025-08-18 21:23:19,425 INFO Feature importance plot saved to evaluation/feature_importance.png
[2025-08-18T21:23:19.429+0000] {subprocess.py:93} INFO - 2025-08-18 21:23:19,427 INFO Performing cross-validation...
[2025-08-18T21:23:19.430+0000] {subprocess.py:93} INFO - 2025-08-18 21:23:19,428 INFO Performing cross-validation...
[2025-08-18T21:24:24.603+0000] {subprocess.py:93} INFO - 2025-08-18 21:24:24,593 INFO ACCURACY: 0.7470 (+/- 0.0077)
[2025-08-18T21:24:24.622+0000] {subprocess.py:93} INFO - 2025-08-18 21:24:24,602 INFO PRECISION: 0.5155 (+/- 0.0099)
[2025-08-18T21:24:24.633+0000] {subprocess.py:93} INFO - 2025-08-18 21:24:24,607 INFO RECALL: 0.8010 (+/- 0.0385)
[2025-08-18T21:24:24.644+0000] {subprocess.py:93} INFO - 2025-08-18 21:24:24,618 INFO F1: 0.6272 (+/- 0.0137)
[2025-08-18T21:24:24.647+0000] {subprocess.py:93} INFO - 2025-08-18 21:24:24,639 INFO ROC_AUC: 0.8446 (+/- 0.0098)
[2025-08-18T21:24:24.650+0000] {subprocess.py:93} INFO - 2025-08-18 21:24:24,648 INFO Loaded best run ID: b682dba240844ed68344d97d245b4459
[2025-08-18T21:24:28.698+0000] {subprocess.py:93} INFO - 2025-08-18 21:24:28,697 INFO Evaluation results logged to MLflow
[2025-08-18T21:24:28.900+0000] {subprocess.py:93} INFO - 2025-08-18 21:24:28,899 INFO Evaluation report saved to evaluation/evaluation_report.md
[2025-08-18T21:24:28.901+0000] {subprocess.py:93} INFO - 2025-08-18 21:24:28,900 INFO ==================================================
[2025-08-18T21:24:28.901+0000] {subprocess.py:93} INFO - 2025-08-18 21:24:28,900 INFO MODEL EVALUATION COMPLETE!
[2025-08-18T21:24:28.902+0000] {subprocess.py:93} INFO - 2025-08-18 21:24:28,901 INFO ==================================================
[2025-08-18T21:24:28.903+0000] {subprocess.py:93} INFO - 2025-08-18 21:24:28,901 INFO Test Accuracy: 0.7306
[2025-08-18T21:24:28.903+0000] {subprocess.py:93} INFO - 2025-08-18 21:24:28,902 INFO Test Precision: 0.4958
[2025-08-18T21:24:28.903+0000] {subprocess.py:93} INFO - 2025-08-18 21:24:28,902 INFO Test Recall: 0.7807
[2025-08-18T21:24:28.904+0000] {subprocess.py:93} INFO - 2025-08-18 21:24:28,902 INFO Test F1-Score: 0.6064
[2025-08-18T21:24:28.904+0000] {subprocess.py:93} INFO - 2025-08-18 21:24:28,903 INFO Test ROC-AUC: 0.8307
[2025-08-18T21:24:28.905+0000] {subprocess.py:93} INFO - 2025-08-18 21:24:28,903 INFO Evaluation report: evaluation/evaluation_report.md
[2025-08-18T21:24:28.906+0000] {subprocess.py:93} INFO - 2025-08-18 21:24:28,904 INFO ==================================================
[2025-08-18T21:24:29.283+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2025-08-18T21:24:29.318+0000] {taskinstance.py:1149} INFO - Marking task as SUCCESS. dag_id=customer_churn_pipeline, task_id=model_evaluation, execution_date=20250818T212219, start_date=20250818T212314, end_date=20250818T212429
[2025-08-18T21:24:29.379+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-08-18T21:24:29.408+0000] {taskinstance.py:3312} INFO - 1 downstream tasks scheduled from follow-on schedule check
