[2025-08-20T17:51:01.528+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: customer_churn_pipeline.model_evaluation scheduled__2025-08-19T00:00:00+00:00 [queued]>
[2025-08-20T17:51:01.571+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: customer_churn_pipeline.model_evaluation scheduled__2025-08-19T00:00:00+00:00 [queued]>
[2025-08-20T17:51:01.572+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2025-08-20T17:51:01.679+0000] {taskinstance.py:2217} INFO - Executing <Task(BashOperator): model_evaluation> on 2025-08-19 00:00:00+00:00
[2025-08-20T17:51:01.699+0000] {standard_task_runner.py:60} INFO - Started process 431 to run task
[2025-08-20T17:51:01.719+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'customer_churn_pipeline', 'model_evaluation', 'scheduled__2025-08-19T00:00:00+00:00', '--job-id', '14', '--raw', '--subdir', 'DAGS_FOLDER/customer_churn_pipeline_dag.py', '--cfg-path', '/tmp/tmpi6w7u39o']
[2025-08-20T17:51:01.744+0000] {standard_task_runner.py:88} INFO - Job 14: Subtask model_evaluation
[2025-08-20T17:51:01.996+0000] {task_command.py:423} INFO - Running <TaskInstance: customer_churn_pipeline.model_evaluation scheduled__2025-08-19T00:00:00+00:00 [running]> on host bd9202be787f
[2025-08-20T17:51:02.457+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='customer_churn_pipeline' AIRFLOW_CTX_TASK_ID='model_evaluation' AIRFLOW_CTX_EXECUTION_DATE='2025-08-19T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-08-19T00:00:00+00:00'
[2025-08-20T17:51:02.483+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-08-20T17:51:02.534+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /opt/***/Customer_Churn_Prediction_Pipeline && python src/model_evaluation.py']
[2025-08-20T17:51:02.680+0000] {subprocess.py:86} INFO - Output:
[2025-08-20T17:51:16.741+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:16,739 INFO Starting model evaluation...
[2025-08-20T17:51:16.865+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:16,864 INFO Model loaded from models/churn_model.pkl
[2025-08-20T17:51:16.866+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:16,865 INFO Loading data for evaluation...
[2025-08-20T17:51:16.867+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:16,865 INFO Connecting to SQLite DB at data/features/churn_features.db
[2025-08-20T17:51:16.895+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:16,893 INFO Available tables: ['churn_features']
[2025-08-20T17:51:17.886+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:17,881 INFO Retrieved 7032 rows and 36 columns from table churn_features
[2025-08-20T17:51:17.891+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:17,890 INFO Found target column 'Churn'. Processing...
[2025-08-20T17:51:17.892+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:17,891 INFO Raw target column stats:
[2025-08-20T17:51:17.893+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:17,892 INFO   - Type: float64
[2025-08-20T17:51:17.894+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:17,892 INFO   - Unique values: [-0.601663392508594, 1.6620589061112205]
[2025-08-20T17:51:17.896+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:17,895 INFO   - Value counts:
[2025-08-20T17:51:17.897+0000] {subprocess.py:93} INFO - -0.601663    5163
[2025-08-20T17:51:17.898+0000] {subprocess.py:93} INFO -  1.662059    1869
[2025-08-20T17:51:17.900+0000] {subprocess.py:93} INFO - Name: Churn, dtype: int64
[2025-08-20T17:51:17.905+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:17,899 INFO Original target values before normalization: -0.601663    5163
[2025-08-20T17:51:17.912+0000] {subprocess.py:93} INFO -  1.662059    1869
[2025-08-20T17:51:17.914+0000] {subprocess.py:93} INFO - Name: Churn, dtype: int64
[2025-08-20T17:51:17.915+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:17,900 INFO Original target dtype: float64
[2025-08-20T17:51:17.916+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:17,906 INFO Unique numeric values in target: [-0.601663392508594, 1.6620589061112205]
[2025-08-20T17:51:17.917+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:17,916 INFO Binary target with values [-0.601663392508594, 1.6620589061112205]. Mapping to (0,1).
[2025-08-20T17:51:17.921+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:17,918 INFO Mapped -0.601663392508594→0, 1.6620589061112205→1
[2025-08-20T17:51:17.924+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:17,924 INFO Final normalized target stats:
[2025-08-20T17:51:17.926+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:17,925 INFO   - Unique values: [0, 1]
[2025-08-20T17:51:17.927+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:17,927 INFO   - Value counts:
[2025-08-20T17:51:17.928+0000] {subprocess.py:93} INFO - 0    5163
[2025-08-20T17:51:17.929+0000] {subprocess.py:93} INFO - 1    1869
[2025-08-20T17:51:17.930+0000] {subprocess.py:93} INFO - Name: Churn, dtype: int64
[2025-08-20T17:51:17.932+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:17,927 INFO Features shape before dtype fix: (7032, 35), Target shape: (7032,)
[2025-08-20T17:51:17.989+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:17,988 INFO Features dtypes after fix:
[2025-08-20T17:51:17.990+0000] {subprocess.py:93} INFO - gender                                   float64
[2025-08-20T17:51:17.991+0000] {subprocess.py:93} INFO - SeniorCitizen                            float64
[2025-08-20T17:51:17.993+0000] {subprocess.py:93} INFO - Partner                                  float64
[2025-08-20T17:51:17.994+0000] {subprocess.py:93} INFO - Dependents                               float64
[2025-08-20T17:51:17.998+0000] {subprocess.py:93} INFO - tenure                                   float64
[2025-08-20T17:51:17.999+0000] {subprocess.py:93} INFO - PhoneService                             float64
[2025-08-20T17:51:18.000+0000] {subprocess.py:93} INFO - PaperlessBilling                         float64
[2025-08-20T17:51:18.001+0000] {subprocess.py:93} INFO - MonthlyCharges                           float64
[2025-08-20T17:51:18.002+0000] {subprocess.py:93} INFO - TotalCharges                             float64
[2025-08-20T17:51:18.004+0000] {subprocess.py:93} INFO - TotalChargesPerTenure                    float64
[2025-08-20T17:51:18.005+0000] {subprocess.py:93} INFO - MultipleLines_No phone service           float64
[2025-08-20T17:51:18.007+0000] {subprocess.py:93} INFO - MultipleLines_Yes                        float64
[2025-08-20T17:51:18.015+0000] {subprocess.py:93} INFO - InternetService_Fiber optic              float64
[2025-08-20T17:51:18.024+0000] {subprocess.py:93} INFO - InternetService_No                       float64
[2025-08-20T17:51:18.055+0000] {subprocess.py:93} INFO - OnlineSecurity_No internet service       float64
[2025-08-20T17:51:18.061+0000] {subprocess.py:93} INFO - OnlineSecurity_Yes                       float64
[2025-08-20T17:51:18.063+0000] {subprocess.py:93} INFO - OnlineBackup_No internet service         float64
[2025-08-20T17:51:18.072+0000] {subprocess.py:93} INFO - OnlineBackup_Yes                         float64
[2025-08-20T17:51:18.076+0000] {subprocess.py:93} INFO - DeviceProtection_No internet service     float64
[2025-08-20T17:51:18.080+0000] {subprocess.py:93} INFO - DeviceProtection_Yes                     float64
[2025-08-20T17:51:18.081+0000] {subprocess.py:93} INFO - TechSupport_No internet service          float64
[2025-08-20T17:51:18.083+0000] {subprocess.py:93} INFO - TechSupport_Yes                          float64
[2025-08-20T17:51:18.095+0000] {subprocess.py:93} INFO - StreamingTV_No internet service          float64
[2025-08-20T17:51:18.106+0000] {subprocess.py:93} INFO - StreamingTV_Yes                          float64
[2025-08-20T17:51:18.107+0000] {subprocess.py:93} INFO - StreamingMovies_No internet service      float64
[2025-08-20T17:51:18.111+0000] {subprocess.py:93} INFO - StreamingMovies_Yes                      float64
[2025-08-20T17:51:18.112+0000] {subprocess.py:93} INFO - Contract_One year                        float64
[2025-08-20T17:51:18.113+0000] {subprocess.py:93} INFO - Contract_Two year                        float64
[2025-08-20T17:51:18.114+0000] {subprocess.py:93} INFO - PaymentMethod_Credit card (automatic)    float64
[2025-08-20T17:51:18.114+0000] {subprocess.py:93} INFO - PaymentMethod_Electronic check           float64
[2025-08-20T17:51:18.115+0000] {subprocess.py:93} INFO - PaymentMethod_Mailed check               float64
[2025-08-20T17:51:18.116+0000] {subprocess.py:93} INFO - TenureGroup_13-24                        float64
[2025-08-20T17:51:18.123+0000] {subprocess.py:93} INFO - TenureGroup_25-48                        float64
[2025-08-20T17:51:18.137+0000] {subprocess.py:93} INFO - TenureGroup_49-60                        float64
[2025-08-20T17:51:18.141+0000] {subprocess.py:93} INFO - TenureGroup_61+                          float64
[2025-08-20T17:51:18.149+0000] {subprocess.py:93} INFO - dtype: object
[2025-08-20T17:51:18.152+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:17,989 INFO Data loaded: 7032 samples, 35 features
[2025-08-20T17:51:18.154+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:17,990 INFO Classes in evaluation data: [0 1]
[2025-08-20T17:51:18.155+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:18,009 INFO Making predictions on test set...
[2025-08-20T17:51:18.181+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:18,060 INFO Calculating evaluation metrics...
[2025-08-20T17:51:18.182+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:18,180 INFO Creating evaluation plots...
[2025-08-20T17:51:19.913+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:19,907 INFO Confusion matrix saved to evaluation/confusion_matrix.png
[2025-08-20T17:51:22.425+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:22,424 INFO ROC curve saved to evaluation/roc_curve.png
[2025-08-20T17:51:25.161+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:25,152 INFO Precision-Recall curve saved to evaluation/precision_recall_curve.png
[2025-08-20T17:51:25.288+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:25,287 INFO Feature importance plot saved to evaluation/feature_importance.png
[2025-08-20T17:51:25.289+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:25,288 INFO Performing cross-validation...
[2025-08-20T17:51:25.290+0000] {subprocess.py:93} INFO - 2025-08-20 17:51:25,289 INFO Performing cross-validation...
[2025-08-20T17:52:25.812+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:25,793 INFO ACCURACY: 0.7470 (+/- 0.0077)
[2025-08-20T17:52:25.820+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:25,805 INFO PRECISION: 0.5155 (+/- 0.0099)
[2025-08-20T17:52:25.824+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:25,821 INFO RECALL: 0.8010 (+/- 0.0385)
[2025-08-20T17:52:25.860+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:25,826 INFO F1: 0.6272 (+/- 0.0137)
[2025-08-20T17:52:25.888+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:25,829 INFO ROC_AUC: 0.8446 (+/- 0.0098)
[2025-08-20T17:52:25.893+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:25,838 INFO Loaded best run ID: d58cbb1df47a44b0a994ac020152d04d
[2025-08-20T17:52:35.119+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:35,118 INFO Evaluation results logged to MLflow
[2025-08-20T17:52:35.509+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:35,508 INFO Evaluation report saved to evaluation/evaluation_report.md
[2025-08-20T17:52:35.511+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:35,509 INFO ==================================================
[2025-08-20T17:52:35.512+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:35,510 INFO MODEL EVALUATION COMPLETE!
[2025-08-20T17:52:35.514+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:35,511 INFO ==================================================
[2025-08-20T17:52:35.515+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:35,512 INFO Test Accuracy: 0.7306
[2025-08-20T17:52:35.519+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:35,512 INFO Test Precision: 0.4958
[2025-08-20T17:52:35.522+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:35,513 INFO Test Recall: 0.7807
[2025-08-20T17:52:35.524+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:35,514 INFO Test F1-Score: 0.6064
[2025-08-20T17:52:35.527+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:35,514 INFO Test ROC-AUC: 0.8307
[2025-08-20T17:52:35.529+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:35,515 INFO Evaluation report: evaluation/evaluation_report.md
[2025-08-20T17:52:35.530+0000] {subprocess.py:93} INFO - 2025-08-20 17:52:35,515 INFO ==================================================
[2025-08-20T17:52:36.846+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2025-08-20T17:52:36.978+0000] {taskinstance.py:1149} INFO - Marking task as SUCCESS. dag_id=customer_churn_pipeline, task_id=model_evaluation, execution_date=20250819T000000, start_date=20250820T175101, end_date=20250820T175236
[2025-08-20T17:52:37.071+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-08-20T17:52:37.215+0000] {taskinstance.py:3312} INFO - 1 downstream tasks scheduled from follow-on schedule check
