2025-08-19 02:47:18,273 INFO Starting model evaluation...
2025-08-19 02:47:18,368 INFO Model loaded from models\churn_model.pkl
2025-08-19 02:47:18,368 INFO Loading data for evaluation...
2025-08-19 02:47:18,369 INFO Connecting to SQLite DB at data\features\churn_features.db
2025-08-19 02:47:18,372 INFO Available tables: ['churn_features']
2025-08-19 02:47:18,453 INFO Retrieved 7032 rows and 36 columns from table churn_features
2025-08-19 02:47:18,454 INFO Found target column 'Churn'. Processing...
2025-08-19 02:47:18,454 INFO Raw target column stats:
2025-08-19 02:47:18,455 INFO   - Type: float64
2025-08-19 02:47:18,457 INFO   - Unique values: [-0.601663392508594, 1.6620589061112205]
2025-08-19 02:47:18,459 INFO   - Value counts:
Churn
-0.601663    5163
 1.662059    1869
Name: count, dtype: int64
2025-08-19 02:47:18,461 INFO Original target values before normalization: Churn
-0.601663    5163
 1.662059    1869
Name: count, dtype: int64
2025-08-19 02:47:18,461 INFO Original target dtype: float64
2025-08-19 02:47:18,462 INFO Unique numeric values in target: [-0.601663392508594, 1.6620589061112205]
2025-08-19 02:47:18,463 INFO Binary target with values [-0.601663392508594, 1.6620589061112205]. Mapping to (0,1).
2025-08-19 02:47:18,473 INFO Final normalized target stats:
2025-08-19 02:47:18,474 INFO   - Unique values: [0, 1]
2025-08-19 02:47:18,474 INFO   - Value counts:
Churn
0    5163
1    1869
Name: count, dtype: int64
2025-08-19 02:47:18,476 INFO Features shape before dtype fix: (7032, 35), Target shape: (7032,)
2025-08-19 02:47:18,485 INFO Features dtypes after fix:
gender                                   float64
SeniorCitizen                            float64
Partner                                  float64
Dependents                               float64
tenure                                   float64
PhoneService                             float64
PaperlessBilling                         float64
MonthlyCharges                           float64
TotalCharges                             float64
TotalChargesPerTenure                    float64
MultipleLines_No phone service           float64
MultipleLines_Yes                        float64
InternetService_Fiber optic              float64
InternetService_No                       float64
OnlineSecurity_No internet service       float64
OnlineSecurity_Yes                       float64
OnlineBackup_No internet service         float64
OnlineBackup_Yes                         float64
DeviceProtection_No internet service     float64
DeviceProtection_Yes                     float64
TechSupport_No internet service          float64
TechSupport_Yes                          float64
StreamingTV_No internet service          float64
StreamingTV_Yes                          float64
StreamingMovies_No internet service      float64
StreamingMovies_Yes                      float64
Contract_One year                        float64
Contract_Two year                        float64
PaymentMethod_Credit card (automatic)    float64
PaymentMethod_Electronic check           float64
PaymentMethod_Mailed check               float64
TenureGroup_13-24                        float64
TenureGroup_25-48                        float64
TenureGroup_49-60                        float64
TenureGroup_61+                          float64
dtype: object
2025-08-19 02:47:18,486 INFO Data loaded: 7032 samples, 35 features
2025-08-19 02:47:18,487 INFO Classes in evaluation data: [0 1]
2025-08-19 02:47:18,495 INFO Making predictions on test set...
2025-08-19 02:47:18,500 INFO Calculating evaluation metrics...
2025-08-19 02:47:18,515 INFO Creating evaluation plots...
2025-08-19 02:47:19,500 INFO Confusion matrix saved to evaluation\confusion_matrix.png
2025-08-19 02:47:19,939 INFO ROC curve saved to evaluation\roc_curve.png
2025-08-19 02:47:20,338 INFO Precision-Recall curve saved to evaluation\precision_recall_curve.png
2025-08-19 02:47:20,976 INFO Feature importance plot saved to evaluation\feature_importance.png
2025-08-19 02:47:20,977 INFO Performing cross-validation...
2025-08-19 02:47:20,979 INFO Performing cross-validation...
2025-08-19 02:47:21,386 ERROR Evaluation failed: got an unexpected keyword argument 'zero_division'
2025-08-19 02:48:22,667 INFO Starting model evaluation...
2025-08-19 02:48:22,777 INFO Model loaded from models\churn_model.pkl
2025-08-19 02:48:22,778 INFO Loading data for evaluation...
2025-08-19 02:48:22,778 INFO Connecting to SQLite DB at data\features\churn_features.db
2025-08-19 02:48:22,782 INFO Available tables: ['churn_features']
2025-08-19 02:48:22,925 INFO Retrieved 7032 rows and 36 columns from table churn_features
2025-08-19 02:48:22,927 INFO Found target column 'Churn'. Processing...
2025-08-19 02:48:22,928 INFO Raw target column stats:
2025-08-19 02:48:22,928 INFO   - Type: float64
2025-08-19 02:48:22,930 INFO   - Unique values: [-0.601663392508594, 1.6620589061112205]
2025-08-19 02:48:22,932 INFO   - Value counts:
Churn
-0.601663    5163
 1.662059    1869
Name: count, dtype: int64
2025-08-19 02:48:22,934 INFO Original target values before normalization: Churn
-0.601663    5163
 1.662059    1869
Name: count, dtype: int64
2025-08-19 02:48:22,935 INFO Original target dtype: float64
2025-08-19 02:48:22,937 INFO Unique numeric values in target: [-0.601663392508594, 1.6620589061112205]
2025-08-19 02:48:22,937 INFO Binary target with values [-0.601663392508594, 1.6620589061112205]. Mapping to (0,1).
2025-08-19 02:48:22,950 INFO Final normalized target stats:
2025-08-19 02:48:22,951 INFO   - Unique values: [0, 1]
2025-08-19 02:48:22,954 INFO   - Value counts:
Churn
0    5163
1    1869
Name: count, dtype: int64
2025-08-19 02:48:22,954 INFO Features shape before dtype fix: (7032, 35), Target shape: (7032,)
2025-08-19 02:48:22,970 INFO Features dtypes after fix:
gender                                   float64
SeniorCitizen                            float64
Partner                                  float64
Dependents                               float64
tenure                                   float64
PhoneService                             float64
PaperlessBilling                         float64
MonthlyCharges                           float64
TotalCharges                             float64
TotalChargesPerTenure                    float64
MultipleLines_No phone service           float64
MultipleLines_Yes                        float64
InternetService_Fiber optic              float64
InternetService_No                       float64
OnlineSecurity_No internet service       float64
OnlineSecurity_Yes                       float64
OnlineBackup_No internet service         float64
OnlineBackup_Yes                         float64
DeviceProtection_No internet service     float64
DeviceProtection_Yes                     float64
TechSupport_No internet service          float64
TechSupport_Yes                          float64
StreamingTV_No internet service          float64
StreamingTV_Yes                          float64
StreamingMovies_No internet service      float64
StreamingMovies_Yes                      float64
Contract_One year                        float64
Contract_Two year                        float64
PaymentMethod_Credit card (automatic)    float64
PaymentMethod_Electronic check           float64
PaymentMethod_Mailed check               float64
TenureGroup_13-24                        float64
TenureGroup_25-48                        float64
TenureGroup_49-60                        float64
TenureGroup_61+                          float64
dtype: object
2025-08-19 02:48:22,971 INFO Data loaded: 7032 samples, 35 features
2025-08-19 02:48:22,972 INFO Classes in evaluation data: [0 1]
2025-08-19 02:48:22,984 INFO Making predictions on test set...
2025-08-19 02:48:22,993 INFO Calculating evaluation metrics...
2025-08-19 02:48:23,020 INFO Creating evaluation plots...
2025-08-19 02:48:24,034 INFO Confusion matrix saved to evaluation\confusion_matrix.png
2025-08-19 02:48:24,548 INFO ROC curve saved to evaluation\roc_curve.png
2025-08-19 02:48:24,988 INFO Precision-Recall curve saved to evaluation\precision_recall_curve.png
2025-08-19 02:48:25,581 INFO Feature importance plot saved to evaluation\feature_importance.png
2025-08-19 02:48:25,582 INFO Performing cross-validation...
2025-08-19 02:48:25,582 INFO Performing cross-validation...
2025-08-19 02:48:27,568 INFO ACCURACY: 0.7467 (+/- 0.0077)
2025-08-19 02:48:27,568 INFO PRECISION: 0.5152 (+/- 0.0098)
2025-08-19 02:48:27,568 INFO RECALL: 0.8010 (+/- 0.0385)
2025-08-19 02:48:27,569 INFO F1: 0.6269 (+/- 0.0144)
2025-08-19 02:48:27,569 INFO ROC_AUC: 0.8446 (+/- 0.0099)
2025-08-19 02:48:27,576 INFO Loaded best run ID: 5183fedfa78c48cbb36e6fee2581613a
2025-08-19 02:48:29,472 INFO Evaluation results logged to MLflow
2025-08-19 02:48:29,496 INFO Evaluation report saved to evaluation\evaluation_report.md
2025-08-19 02:48:29,496 INFO ==================================================
2025-08-19 02:48:29,498 INFO MODEL EVALUATION COMPLETE!
2025-08-19 02:48:29,498 INFO ==================================================
2025-08-19 02:48:29,498 INFO Test Accuracy: 0.7306
2025-08-19 02:48:29,499 INFO Test Precision: 0.4958
2025-08-19 02:48:29,500 INFO Test Recall: 0.7807
2025-08-19 02:48:29,500 INFO Test F1-Score: 0.6064
2025-08-19 02:48:29,501 INFO Test ROC-AUC: 0.8307
2025-08-19 02:48:29,501 INFO Evaluation report: evaluation\evaluation_report.md
2025-08-19 02:48:29,502 INFO ==================================================
2025-08-18 21:23:17,076 INFO Starting model evaluation...
2025-08-18 21:23:17,116 INFO Model loaded from models/churn_model.pkl
2025-08-18 21:23:17,117 INFO Loading data for evaluation...
2025-08-18 21:23:17,117 INFO Connecting to SQLite DB at data/features/churn_features.db
2025-08-18 21:23:17,134 INFO Available tables: ['churn_features']
2025-08-18 21:23:17,380 INFO Retrieved 7032 rows and 36 columns from table churn_features
2025-08-18 21:23:17,385 INFO Found target column 'Churn'. Processing...
2025-08-18 21:23:17,386 INFO Raw target column stats:
2025-08-18 21:23:17,386 INFO   - Type: float64
2025-08-18 21:23:17,387 INFO   - Unique values: [-0.601663392508594, 1.6620589061112205]
2025-08-18 21:23:17,389 INFO   - Value counts:
-0.601663    5163
 1.662059    1869
Name: Churn, dtype: int64
2025-08-18 21:23:17,390 INFO Original target values before normalization: -0.601663    5163
 1.662059    1869
Name: Churn, dtype: int64
2025-08-18 21:23:17,391 INFO Original target dtype: float64
2025-08-18 21:23:17,391 INFO Unique numeric values in target: [-0.601663392508594, 1.6620589061112205]
2025-08-18 21:23:17,392 INFO Binary target with values [-0.601663392508594, 1.6620589061112205]. Mapping to (0,1).
2025-08-18 21:23:17,393 INFO Mapped -0.601663392508594→0, 1.6620589061112205→1
2025-08-18 21:23:17,395 INFO Final normalized target stats:
2025-08-18 21:23:17,395 INFO   - Unique values: [0, 1]
2025-08-18 21:23:17,397 INFO   - Value counts:
0    5163
1    1869
Name: Churn, dtype: int64
2025-08-18 21:23:17,397 INFO Features shape before dtype fix: (7032, 35), Target shape: (7032,)
2025-08-18 21:23:17,409 INFO Features dtypes after fix:
gender                                   float64
SeniorCitizen                            float64
Partner                                  float64
Dependents                               float64
tenure                                   float64
PhoneService                             float64
PaperlessBilling                         float64
MonthlyCharges                           float64
TotalCharges                             float64
TotalChargesPerTenure                    float64
MultipleLines_No phone service           float64
MultipleLines_Yes                        float64
InternetService_Fiber optic              float64
InternetService_No                       float64
OnlineSecurity_No internet service       float64
OnlineSecurity_Yes                       float64
OnlineBackup_No internet service         float64
OnlineBackup_Yes                         float64
DeviceProtection_No internet service     float64
DeviceProtection_Yes                     float64
TechSupport_No internet service          float64
TechSupport_Yes                          float64
StreamingTV_No internet service          float64
StreamingTV_Yes                          float64
StreamingMovies_No internet service      float64
StreamingMovies_Yes                      float64
Contract_One year                        float64
Contract_Two year                        float64
PaymentMethod_Credit card (automatic)    float64
PaymentMethod_Electronic check           float64
PaymentMethod_Mailed check               float64
TenureGroup_13-24                        float64
TenureGroup_25-48                        float64
TenureGroup_49-60                        float64
TenureGroup_61+                          float64
dtype: object
2025-08-18 21:23:17,411 INFO Data loaded: 7032 samples, 35 features
2025-08-18 21:23:17,412 INFO Classes in evaluation data: [0 1]
2025-08-18 21:23:17,421 INFO Making predictions on test set...
2025-08-18 21:23:17,456 INFO Calculating evaluation metrics...
2025-08-18 21:23:17,508 INFO Creating evaluation plots...
2025-08-18 21:23:17,934 INFO Confusion matrix saved to evaluation/confusion_matrix.png
2025-08-18 21:23:18,414 INFO ROC curve saved to evaluation/roc_curve.png
2025-08-18 21:23:18,823 INFO Precision-Recall curve saved to evaluation/precision_recall_curve.png
2025-08-18 21:23:19,425 INFO Feature importance plot saved to evaluation/feature_importance.png
2025-08-18 21:23:19,427 INFO Performing cross-validation...
2025-08-18 21:23:19,428 INFO Performing cross-validation...
2025-08-18 21:24:24,593 INFO ACCURACY: 0.7470 (+/- 0.0077)
2025-08-18 21:24:24,602 INFO PRECISION: 0.5155 (+/- 0.0099)
2025-08-18 21:24:24,607 INFO RECALL: 0.8010 (+/- 0.0385)
2025-08-18 21:24:24,618 INFO F1: 0.6272 (+/- 0.0137)
2025-08-18 21:24:24,639 INFO ROC_AUC: 0.8446 (+/- 0.0098)
2025-08-18 21:24:24,648 INFO Loaded best run ID: b682dba240844ed68344d97d245b4459
2025-08-18 21:24:28,697 INFO Evaluation results logged to MLflow
2025-08-18 21:24:28,899 INFO Evaluation report saved to evaluation/evaluation_report.md
2025-08-18 21:24:28,900 INFO ==================================================
2025-08-18 21:24:28,900 INFO MODEL EVALUATION COMPLETE!
2025-08-18 21:24:28,901 INFO ==================================================
2025-08-18 21:24:28,901 INFO Test Accuracy: 0.7306
2025-08-18 21:24:28,902 INFO Test Precision: 0.4958
2025-08-18 21:24:28,902 INFO Test Recall: 0.7807
2025-08-18 21:24:28,902 INFO Test F1-Score: 0.6064
2025-08-18 21:24:28,903 INFO Test ROC-AUC: 0.8307
2025-08-18 21:24:28,903 INFO Evaluation report: evaluation/evaluation_report.md
2025-08-18 21:24:28,904 INFO ==================================================
